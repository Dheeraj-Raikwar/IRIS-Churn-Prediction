<?xml version="1.0"?>
<AlteryxDocument yxmdVer="2022.1">
  <Nodes>
    <Node ToolID="133">
      <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
        <Position x="1938" y="116" width="217" height="133" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Caption>Join 360 and snowball</Caption>
          <Style TextColor="#314c4a" FillColor="#ecf2f2" BorderColor="#314c4a" Transparency="25" Margin="25" />
          <Disabled value="False" />
          <Folded value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <ChildNodes>
        <Node ToolID="134">
          <GuiSettings Plugin="AlteryxBasePluginsGui.Join.Join">
            <Position x="1963" y="165" />
          </GuiSettings>
          <Properties>
            <Configuration joinByRecordPos="False">
              <JoinInfo connection="Left">
                <Field field="Parent_Customer_ID" />
                <Field field="Month" />
              </JoinInfo>
              <JoinInfo connection="Right">
                <Field field="Parent customer ID" />
                <Field field="Month" />
              </JoinInfo>
              <SelectConfiguration>
                <Configuration outputConnection="Join">
                  <OrderChanged value="True" />
                  <CommaDecimal value="False" />
                  <SelectFields>
                    <SelectField field="Right_Account Manager" selected="True" input="Right_" />
                    <SelectField field="Right_Accountancy" selected="False" input="Right_" />
                    <SelectField field="Left_ARR" selected="True" input="Left_" />
                    <SelectField field="Left_ARR_12mo_ago" selected="True" input="Left_" />
                    <SelectField field="Left_ARR_LM" selected="True" input="Left_" />
                    <SelectField field="Left_ARR_vs_12mo_ago" selected="True" input="Left_" />
                    <SelectField field="Left_ARR_vs_LM" selected="True" input="Left_" />
                    <SelectField field="Left_Child_ID" selected="True" input="Left_" />
                    <SelectField field="Right_Company Size" selected="True" input="Right_" />
                    <SelectField field="Left_Customer Cohort Year" selected="True" input="Left_" />
                    <SelectField field="Right_Customer Cohort Year" selected="True" rename="Right_Customer Cohort Year" input="Right_" />
                    <SelectField field="Left_Customer_Churn" selected="True" input="Left_" />
                    <SelectField field="Left_Customer_Churn_Month" selected="True" input="Left_" />
                    <SelectField field="Right_Customer_Discount_%_of_ARR" selected="True" input="Right_" />
                    <SelectField field="Left_Customer_Or_Product_Churn" selected="True" input="Left_" />
                    <SelectField field="Right_EBITDA LAY" selected="True" input="Right_" />
                    <SelectField field="Right_Employee Count" selected="True" input="Right_" />
                    <SelectField field="Left_First_Date_In_Snowball" selected="True" input="Left_" />
                    <SelectField field="Left_First_Date_In_Snowball_Annual_Delta_ARR" selected="True" input="Left_" />
                    <SelectField field="Left_First_Date_In_Snowball_ARR" selected="True" input="Left_" />
                    <SelectField field="Left_First_Date_In_Snowball_CAGR_ARR" selected="True" input="Left_" />
                    <SelectField field="Left_First_Date_In_Snowball_Delta_ARR" selected="True" input="Left_" />
                    <SelectField field="Left_First_Date_In_Snowball_Delta_ARR_%" selected="True" input="Left_" />
                    <SelectField field="Right_Flag_L12M_Decrease_in_NPS_Score" selected="True" input="Right_" />
                    <SelectField field="Right_Flag_L24M_Decrease_in_NPS_Score" selected="True" input="Right_" />
                    <SelectField field="Right_Industry" selected="True" input="Right_" />
                    <SelectField field="Right_Interactions (in-month)" selected="True" input="Right_" />
                    <SelectField field="Right_L12M account managers" selected="True" input="Right_" />
                    <SelectField field="Right_L12M AM interactions" selected="True" input="Right_" />
                    <SelectField field="Right_L12M credit notes" selected="True" input="Right_" />
                    <SelectField field="Right_L12M escalated tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L12M Escalation Flag" selected="True" input="Right_" />
                    <SelectField field="Right_L12M incorrect billing credit notes" selected="True" input="Right_" />
                    <SelectField field="Right_L12M increase in amber tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L12M increase in red tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L12M increase in tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L12M increase in tickets2" selected="True" input="Right_" />
                    <SelectField field="Right_L12M licenses" selected="True" input="Right_" />
                    <SelectField field="Right_L12M licenses delta" selected="True" input="Right_" />
                    <SelectField field="Right_L12M SLA closure violations" selected="True" input="Right_" />
                    <SelectField field="Right_L12M SLA response violations" selected="True" input="Right_" />
                    <SelectField field="Right_L12M SLA violations" selected="True" input="Right_" />
                    <SelectField field="Right_L12M ticket count" selected="True" input="Right_" />
                    <SelectField field="Right_L12M tickets (amber)" selected="True" input="Right_" />
                    <SelectField field="Right_L12M tickets (green)" selected="True" input="Right_" />
                    <SelectField field="Right_L12M tickets (red)" selected="True" input="Right_" />
                    <SelectField field="Right_L12M tickets closed in 24 hours" selected="True" input="Right_" />
                    <SelectField field="Right_L12M tickets closed in 48 hours" selected="True" input="Right_" />
                    <SelectField field="Right_L12M tickets reopened" selected="True" input="Right_" />
                    <SelectField field="Right_L12M total days tickets open" selected="True" input="Right_" />
                    <SelectField field="Right_L12M total discount" selected="True" input="Right_" />
                    <SelectField field="Right_L12M_Avg_NPS_Score" selected="True" input="Right_" />
                    <SelectField field="Right_L12M_Change_in_NPS_Score" selected="True" input="Right_" />
                    <SelectField field="Right_L12M_Credit_Note_Count" selected="True" input="Right_" />
                    <SelectField field="Right_L12M_Interactions_Change" selected="True" input="Right_" />
                    <SelectField field="Right_L24M_Change_in_NPS_Score" selected="True" input="Right_" />
                    <SelectField field="Right_L2M credit notes" selected="True" input="Right_" />
                    <SelectField field="Right_L2M incorrect billing credit notes" selected="True" input="Right_" />
                    <SelectField field="Right_L3M escalated tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L3M increase in amber tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L3M increase in red tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L3M increase in tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L3M inrease in tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L3M SLA closure violations" selected="True" input="Right_" />
                    <SelectField field="Right_L3M SLA response violations" selected="True" input="Right_" />
                    <SelectField field="Right_L3M SLA violations" selected="True" input="Right_" />
                    <SelectField field="Right_L3M ticket count" selected="True" input="Right_" />
                    <SelectField field="Right_L3M tickets (amber)" selected="True" input="Right_" />
                    <SelectField field="Right_L3M tickets (green)" selected="True" input="Right_" />
                    <SelectField field="Right_L3M tickets (red)" selected="True" input="Right_" />
                    <SelectField field="Right_L3M tickets closed in 24 hours" selected="True" input="Right_" />
                    <SelectField field="Right_L3M tickets closed in 48 hours" selected="True" input="Right_" />
                    <SelectField field="Right_L3M tickets reopened" selected="True" input="Right_" />
                    <SelectField field="Right_L3M total days ticket open" selected="True" input="Right_" />
                    <SelectField field="Right_L3M_Increase_in_Ticket_Count" selected="True" input="Right_" />
                    <SelectField field="Right_L6M account managers" selected="True" input="Right_" />
                    <SelectField field="Right_L6M AM interactions" selected="True" input="Right_" />
                    <SelectField field="Right_L6M credit notes" selected="True" input="Right_" />
                    <SelectField field="Right_L6M escalated tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L6M incorrect billing credit notes" selected="True" input="Right_" />
                    <SelectField field="Right_L6M increase in amber tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L6M increase in red tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L6M increase in tickets" selected="True" input="Right_" />
                    <SelectField field="Right_L6M increase in tickets2" selected="True" input="Right_" />
                    <SelectField field="Right_L6M licenses" selected="True" input="Right_" />
                    <SelectField field="Right_L6M licenses delta" selected="True" input="Right_" />
                    <SelectField field="Right_L6M SLA closure violations" selected="True" input="Right_" />
                    <SelectField field="Right_L6M SLA response violations" selected="True" input="Right_" />
                    <SelectField field="Right_L6M SLA violations" selected="True" input="Right_" />
                    <SelectField field="Right_L6M ticket count" selected="True" input="Right_" />
                    <SelectField field="Right_L6M tickets (amber)" selected="True" input="Right_" />
                    <SelectField field="Right_L6M tickets (green)" selected="True" input="Right_" />
                    <SelectField field="Right_L6M tickets (red)" selected="True" input="Right_" />
                    <SelectField field="Right_L6M tickets closed in 24 hours" selected="True" input="Right_" />
                    <SelectField field="Right_L6M tickets closed in 48 hours" selected="True" input="Right_" />
                    <SelectField field="Right_L6M tickets reopened" selected="True" input="Right_" />
                    <SelectField field="Right_L6M total days tickets open" selected="True" input="Right_" />
                    <SelectField field="Right_Licenses" selected="True" input="Right_" />
                    <SelectField field="Left_LTM_ARR_Decrease" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_AddAcq" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_AddOrg" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_ARR_%" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_Churn" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_Cross_Sell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_Cross_Sell_Organic" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_Downgrade" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_Downsell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_Downsell_Organic" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_Reoccurring" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_Upsell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Delta_Upsell_Organic" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Downsell_Organic_%_ARR" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_AddAcq" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_AddOrg" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Churn" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Cross_Sell" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Cross_Sell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Cross_Sell_Organic" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Downgrade" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Downsell" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Downsell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Downsell_organic" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Existing_Customer" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Existing_Product" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Reoccurring" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Upsell" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Upsell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Flag_Upsell_Organic" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Upsell_Downsell_M&amp;A_%_ARR" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Upsell_Downsell_Organic_%_ARR" selected="True" input="Left_" />
                    <SelectField field="Left_LTM_Upsell_Organic_%_ARR" selected="True" input="Left_" />
                    <SelectField field="Right_M-12_L12M_Avg_NPS_Score" selected="True" input="Right_" />
                    <SelectField field="Right_M-24_L12M_Avg_NPS_Score" selected="True" input="Right_" />
                    <SelectField field="Right_Month" selected="False" rename="Right_Month" input="Right_" />
                    <SelectField field="Left_Month" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_ARR_Decrease" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_AddAcq" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_AddOrg" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_ARR_%" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_Churn" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_Cross_Sell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_Cross_Sell_Organic" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_Downgrade" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_Downsell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_Downsell_Organic" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_Reoccurring" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_Upsell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Delta_Upsell_Organic" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Add" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_AddAcq" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_AddOrg" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Churn" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Cross_Sell" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Cross_Sell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Cross_Sell_Organic" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Downgrade" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Downsell" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Downsell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Downsell_Organic" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Existing_Customer" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Existing_Product" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Reoccurring" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Upsell" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Upsell_M&amp;A" selected="True" input="Left_" />
                    <SelectField field="Left_Monthly_Flag_Upsell_Organic" selected="True" input="Left_" />
                    <SelectField field="Left_Months_Since_First_Date_In_Snowball" selected="True" input="Left_" />
                    <SelectField field="Left_No_of_Product_Groups" selected="True" input="Left_" />
                    <SelectField field="Right_NPS_Classification" selected="True" input="Right_" />
                    <SelectField field="Right_Original Industry" selected="True" input="Right_" />
                    <SelectField field="Right_Other Professional Services" selected="True" input="Right_" />
                    <SelectField field="Right_Parent customer ID" selected="True" input="Right_" />
                    <SelectField field="Right_Parent_BusinessName" selected="True" input="Right_" />
                    <SelectField field="Left_Parent_Customer_ID" selected="True" input="Left_" />
                    <SelectField field="Right_Parent_Division" selected="True" input="Right_" />
                    <SelectField field="Right_Parent_No_of_Product_Groups" selected="True" input="Right_" />
                    <SelectField field="Right_Parent_No_Product_Families" selected="True" input="Right_" />
                    <SelectField field="Right_Pivotal ID" selected="False" input="Right_" />
                    <SelectField field="Right_Previous L12M interactions" selected="True" input="Right_" />
                    <SelectField field="Right_Previous L6M interactions" selected="True" input="Right_" />
                    <SelectField field="Left_Product_Churn" selected="True" input="Left_" />
                    <SelectField field="Left_Product_Family" selected="True" input="Left_" />
                    <SelectField field="Left_Product_Group" selected="True" input="Left_" />
                    <SelectField field="Left_Product_IsCloud" selected="True" input="Left_" />
                    <SelectField field="Left_Product_IsSaaS" selected="True" input="Left_" />
                    <SelectField field="Left_Product_IsUpsell" selected="True" input="Left_" />
                    <SelectField field="Left_Product_Join_Month" selected="True" input="Left_" />
                    <SelectField field="Left_Product_Lifetime" selected="True" input="Left_" />
                    <SelectField field="Right_Responded_to_NPS_Survey" selected="True" input="Right_" />
                    <SelectField field="Right_Revenue LAY" selected="True" input="Right_" />
                    <SelectField field="Right_Right_Accountancy" selected="False" input="Right_" />
                    <SelectField field="Right_Right_Other Professional Services" selected="False" input="Right_" />
                    <SelectField field="Right_Sector" selected="True" input="Right_" />
                    <SelectField field="Left_Tenure_yrs" selected="True" input="Left_" />
                    <SelectField field="Right_Ticket count (in-month)" selected="True" input="Right_" />
                    <SelectField field="Right_Time stamp" selected="True" input="Right_" />
                    <SelectField field="Right_Total ARR" selected="True" input="Right_" />
                    <SelectField field="Left_Total_Monthly_Customer_ARR" selected="True" input="Left_" />
                    <SelectField field="Left_Years_Since_First_Date_In_Snowball" selected="True" input="Left_" />
                    <SelectField field="*Unknown" selected="True" />
                  </SelectFields>
                </Configuration>
              </SelectConfiguration>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxJoin" />
        </Node>
        <Node ToolID="136">
          <GuiSettings Plugin="AlteryxBasePluginsGui.Union.Union">
            <Position x="2071" y="165" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <ByName_ErrorMode>Warning</ByName_ErrorMode>
              <ByName_OutputMode>All</ByName_OutputMode>
              <Mode>ByName</Mode>
              <SetOutputOrder value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxUnion" />
        </Node>
      </ChildNodes>
    </Node>
    <Node ToolID="131">
      <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
        <Position x="54" y="54" width="1838" height="871" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Caption>Snowball ETL</Caption>
          <Style TextColor="#314c4a" FillColor="#ecf2f2" BorderColor="#314c4a" Transparency="25" Margin="25" />
          <Disabled value="False" />
          <Folded value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <ChildNodes>
        <Node ToolID="90">
          <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
            <Position x="79" y="103" width="492" height="244" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Caption>Import snowball data</Caption>
              <Style TextColor="#314c4a" FillColor="#80ff80" BorderColor="#314c4a" Transparency="25" Margin="25" />
              <Disabled value="False" />
              <Folded value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <ChildNodes>
            <Node ToolID="85">
              <GuiSettings Plugin="LockInGui.LockInInput.LockInInput">
                <Position x="104" y="156" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Connection>File:C:\Users\Public\Churn Prediction\1. Alteryx Workflows\In-DB connection.indbc</Connection>
                  <Query>select * 
from [IRIS_EDW].[Snowball_UAT].[04_CustomerProductSnowball_Pathways]
where round(ARR,0) &lt;&gt; 0 and 
"Product_Division" = 'HCM'
and Product_Family not in ('FMP Dom. Bureau','FMP Int. Bureau')</Query>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>HCM data from snowball  filter out
Product_Family  like ('FMP Dom. Bureau','FMP Int. Bureau')</AnnotationText>
                  <DefaultAnnotationText>Source=File:C:\Users\Public\Churn Prediction\1. Alteryx Workflows\In-DB connection.indbc
Query=select * 
from [IRIS_EDW].[S...</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInInput" />
            </Node>
            <Node ToolID="86">
              <GuiSettings Plugin="LockInGui.LockInStreamOut.LockInStreamOut">
                <Position x="487" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Sort value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInStreamOut" />
            </Node>
            <Node ToolID="87">
              <GuiSettings Plugin="LockInGui.LockInSelect.LockInSelect">
                <Position x="392" y="156" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <OrderChanged value="False" />
                  <CommaDecimal value="False" />
                  <SelectFields>
                    <SelectField field="System" selected="False" />
                    <SelectField field="Parent_ID" selected="True" rename="Parent_Customer_ID" />
                    <SelectField field="ARR_LY" selected="False" />
                    <SelectField field="ARR_vs_LY" selected="False" />
                    <SelectField field="Child_BusinessName" selected="False" />
                    <SelectField field="IsRecurring" selected="False" />
                    <SelectField field="Product_Division_Owning" selected="False" />
                    <SelectField field="Re-occurring_monthly" selected="False" />
                    <SelectField field="Re-occurring_yearly" selected="False" />
                    <SelectField field="UseReoccurLogic_Code" selected="False" />
                    <SelectField field="Parent sector" selected="False" />
                    <SelectField field="employee band" selected="False" />
                    <SelectField field="Employee Size" selected="False" />
                    <SelectField field="*Unknown" selected="True" />
                  </SelectFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSelect" />
            </Node>
            <Node ToolID="88">
              <GuiSettings Plugin="LockInGui.LockInFormula.LockInFormula">
                <Position x="306" y="153" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <ValidateBeforeRun value="True" />
                  <FormulaFields>
                    <FormulaField field="ARR" type="Double" expression="round(&quot;ARR&quot;,0)" />
                    <FormulaField field="ARR_12mo_ago" type="Double" expression="round(&quot;ARR_LY&quot;,0)" />
                    <FormulaField field="ARR_LM" type="Double" expression="round(&quot;ARR_LM&quot;,0)" />
                    <FormulaField field="ARR_vs_12mo_ago" type="Double" expression="round(&quot;ARR_vs_LY&quot;,0)" />
                    <FormulaField field="ARR_vs_LM" type="Double" expression="round(&quot;ARR_vs_LM&quot;,0)" />
                  </FormulaFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>Round all ARR values to avoid calculation errors</AnnotationText>
                  <DefaultAnnotationText>ARR=round("ARR",0)
ARR_12mo_ago=round("ARR_LY",0)
ARR_LM=round("ARR_LM",0)
...</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInFormula" />
            </Node>
            <Node ToolID="89">
              <GuiSettings Plugin="LockInGui.LockInFilter.LockInFilter">
                <Position x="200" y="156" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Mode>Custom</Mode>
                  <Expression>"Month" &lt; dateadd(day, 1, dateadd(month, -2, eomonth(getdate())))</Expression>
                  <ValidateBeforeRun value="True" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>Filter out observations pre-2018 and in the future</AnnotationText>
                  <DefaultAnnotationText>"Month" &lt; dateadd(day, 1, dateadd(month, -2, eomonth(getdate(...</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInFilter" />
            </Node>
          </ChildNodes>
        </Node>
        <Node ToolID="93">
          <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
            <Position x="92" y="332" width="193" height="255" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Caption>Churn flags data</Caption>
              <Style TextColor="#314c4a" FillColor="#80ff80" BorderColor="#314c4a" Transparency="25" Margin="25" />
              <Disabled value="False" />
              <Folded value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <ChildNodes>
            <Node ToolID="91">
              <GuiSettings Plugin="LockInGui.LockInInput.LockInInput">
                <Position x="117" y="381" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Connection>File:C:\Users\Public\Churn Prediction\1. Alteryx Workflows\In-DB connection.indbc</Connection>
                  <Query>select [Month],
[Product_Group],
[Product_Family],
[Child_ID],
 [Parent_ID] as [Parent_Customer_ID],
[Monthly_Flag_Churn],
[Monthly_Flag_Downgrade]
from [IRIS_EDW].[Snowball_UAT].[04_CustomerProductSnowball_Pathways]
where year("Month") &gt; 2017 and
"Product_Last_Month" &lt; dateadd(month, -1, dateadd(day, 1, eomonth(getdate()))) and
"Product_Division" = 'HCM' and
([Monthly_Flag_Churn] = 1 or [Monthly_Flag_Downgrade] = 1)
and Product_Family not in ('FMP Dom. Bureau','FMP Int. Bureau')</Query>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>Churn or downgrade in hcm snowball  filter out
Product_Family  like ('FMP Dom. Bureau','FMP Int. Bureau')</AnnotationText>
                  <DefaultAnnotationText>Source=File:C:\Users\Public\Churn Prediction\1. Alteryx Workflows\In-DB connection.indbc
Query=select [Month],
[Product_Gro...</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInInput" />
            </Node>
            <Node ToolID="92">
              <GuiSettings Plugin="LockInGui.LockInStreamOut.LockInStreamOut">
                <Position x="201" y="381" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Sort value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInStreamOut" />
            </Node>
          </ChildNodes>
        </Node>
        <Node ToolID="110">
          <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
            <Position x="501" y="347" width="577" height="553" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Caption>Create churn flags</Caption>
              <Style TextColor="#314c4a" FillColor="#ffff80" BorderColor="#314c4a" Transparency="25" Margin="25" />
              <Disabled value="False" />
              <Folded value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <ChildNodes>
            <Node ToolID="94">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Formula.Formula">
                <Position x="730" y="396" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <FormulaFields>
                    <FormulaField expression="1" field="Customer_Or_Product_Churn" size="2" type="Int16" />
                  </FormulaFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText><![CDATA[Add churn or downgrade flag
]]></AnnotationText>
                  <DefaultAnnotationText><![CDATA[Customer_Or_Product_Churn = 1
]]></DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFormula" />
            </Node>
            <Node ToolID="95">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Filter.Filter">
                <Position x="526" y="564" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Mode>Simple</Mode>
                  <Simple>
                    <Operator>=</Operator>
                    <Field>Monthly_Flag_Churn</Field>
                    <Operands>
                      <IgnoreTimeInDateTime>True</IgnoreTimeInDateTime>
                      <DateType>fixed</DateType>
                      <PeriodDate>2021-03-30 19:47:54</PeriodDate>
                      <PeriodType>
                      </PeriodType>
                      <PeriodCount>0</PeriodCount>
                      <Operand>1</Operand>
                      <StartDate>2021-03-30 19:47:54</StartDate>
                      <EndDate>2021-03-30 19:47:54</EndDate>
                    </Operands>
                  </Simple>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>churn</AnnotationText>
                  <DefaultAnnotationText>[Monthly_Flag_Churn] = 1</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFilter" />
            </Node>
            <Node ToolID="96">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Formula.Formula">
                <Position x="730" y="564" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <FormulaFields>
                    <FormulaField expression="1" field="Customer_Churn" size="2" type="Int16" />
                  </FormulaFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText><![CDATA[add churn flag
]]></AnnotationText>
                  <DefaultAnnotationText><![CDATA[Customer_Churn = 1
]]></DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFormula" />
            </Node>
            <Node ToolID="97">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Filter.Filter">
                <Position x="526" y="732" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Mode>Simple</Mode>
                  <Simple>
                    <Operator>=</Operator>
                    <Field>Monthly_Flag_Downgrade</Field>
                    <Operands>
                      <IgnoreTimeInDateTime>True</IgnoreTimeInDateTime>
                      <DateType>fixed</DateType>
                      <PeriodDate>2021-03-30 19:48:57</PeriodDate>
                      <PeriodType>
                      </PeriodType>
                      <PeriodCount>0</PeriodCount>
                      <Operand>1</Operand>
                      <StartDate>2021-03-30 19:48:57</StartDate>
                      <EndDate>2021-03-30 19:48:57</EndDate>
                    </Operands>
                  </Simple>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>downgrade</AnnotationText>
                  <DefaultAnnotationText>[Monthly_Flag_Downgrade] = 1</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFilter" />
            </Node>
            <Node ToolID="98">
              <GuiSettings Plugin="AlteryxSpatialPluginsGui.Summarize.Summarize">
                <Position x="622" y="396" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Product_Group" action="GroupBy" rename="Product_Group" />
                    <SummarizeField field="Product_Family" action="GroupBy" rename="Product_Family" />
                    <SummarizeField field="Child_ID" action="GroupBy" rename="Child_ID" />
                    <SummarizeField field="Parent_Customer_ID" action="GroupBy" rename="Parent_Customer_ID" />
                    <SummarizeField field="Month" action="Min" rename="Month" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxSpatialPluginsEngine.dll" EngineDllEntryPoint="AlteryxSummarize" />
            </Node>
            <Node ToolID="99">
              <GuiSettings Plugin="AlteryxSpatialPluginsGui.Summarize.Summarize">
                <Position x="622" y="564" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Product_Group" action="GroupBy" rename="Product_Group" />
                    <SummarizeField field="Product_Family" action="GroupBy" rename="Product_Family" />
                    <SummarizeField field="Child_ID" action="GroupBy" rename="Child_ID" />
                    <SummarizeField field="Parent_Customer_ID" action="GroupBy" rename="Parent_Customer_ID" />
                    <SummarizeField field="Month" action="Min" rename="Month" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxSpatialPluginsEngine.dll" EngineDllEntryPoint="AlteryxSummarize" />
            </Node>
            <Node ToolID="100">
              <GuiSettings Plugin="AlteryxSpatialPluginsGui.Summarize.Summarize">
                <Position x="622" y="732" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Product_Group" action="GroupBy" rename="Product_Group" />
                    <SummarizeField field="Product_Family" action="GroupBy" rename="Product_Family" />
                    <SummarizeField field="Child_ID" action="GroupBy" rename="Child_ID" />
                    <SummarizeField field="Parent_Customer_ID" action="GroupBy" rename="Parent_Customer_ID" />
                    <SummarizeField field="Month" action="Min" rename="Month" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxSpatialPluginsEngine.dll" EngineDllEntryPoint="AlteryxSummarize" />
            </Node>
            <Node ToolID="101">
              <GuiSettings Plugin="AlteryxBasePluginsGui.GenerateRows.GenerateRows">
                <Position x="826" y="396" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <UpdateField value="False" />
                  <UpdateField_Name>Month</UpdateField_Name>
                  <CreateField_Name>Months_6_to_12</CreateField_Name>
                  <CreateField_Type>Date</CreateField_Type>
                  <CreateField_Size>10</CreateField_Size>
                  <Expression_Init>DateTimeAdd([Month],-3,'months')</Expression_Init>
                  <Expression_Cond>[Months_6_to_12]&gt;= datetimeadd([Month],-12,'month')</Expression_Cond>
                  <Expression_Loop>datetimeadd([Months_6_to_12],-1,'month')</Expression_Loop>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxGenerateRows" />
            </Node>
            <Node ToolID="102">
              <GuiSettings Plugin="AlteryxBasePluginsGui.GenerateRows.GenerateRows">
                <Position x="826" y="480" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <UpdateField value="False" />
                  <UpdateField_Name>Month</UpdateField_Name>
                  <CreateField_Name>Months_0_to_6</CreateField_Name>
                  <CreateField_Type>Date</CreateField_Type>
                  <CreateField_Size>10</CreateField_Size>
                  <Expression_Init>[Month]</Expression_Init>
                  <Expression_Cond>[Months_0_to_6]&gt; datetimeadd([Month],-3,'month')</Expression_Cond>
                  <Expression_Loop>datetimeadd([Months_0_to_6],-1,'month')</Expression_Loop>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxGenerateRows" />
            </Node>
            <Node ToolID="103">
              <GuiSettings Plugin="AlteryxBasePluginsGui.JoinMultiple.JoinMultiple">
                <Position x="994" y="396" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <JoinByRecPos value="False" />
                  <JoinFields>
                    <JoinInfo connection="#1">
                      <Field field="Product_Group" />
                      <Field field="Product_Family" />
                      <Field field="Child_ID" />
                      <Field field="Parent_Customer_ID" />
                      <Field field="Months_6_to_12" />
                    </JoinInfo>
                    <JoinInfo connection="#2">
                      <Field field="Product_Group" />
                      <Field field="Product_Family" />
                      <Field field="Child_ID" />
                      <Field field="Parent_Customer_ID" />
                      <Field field="Months_6_to_12" />
                    </JoinInfo>
                    <JoinInfo connection="#3">
                      <Field field="Product_Group" />
                      <Field field="Product_Family" />
                      <Field field="Child_ID" />
                      <Field field="Parent_Customer_ID" />
                      <Field field="Months_6_to_12" />
                    </JoinInfo>
                  </JoinFields>
                  <CartesianMode>Error</CartesianMode>
                  <OutputJoinOnly value="False" />
                  <SelectConfiguration>
                    <Configuration outputConnection="Output">
                      <OrderChanged value="False" />
                      <CommaDecimal value="False" />
                      <SelectFields>
                        <SelectField field="Input_#1_Month" selected="False" />
                        <SelectField field="Input_#2_Product_Group" selected="False" rename="Input_#2_Product_Group" />
                        <SelectField field="Input_#2_Product_Family" selected="False" rename="Input_#2_Product_Family" />
                        <SelectField field="Input_#2_Child_ID" selected="False" rename="Input_#2_Child_ID" />
                        <SelectField field="Input_#2_Parent_Customer_ID" selected="False" rename="Input_#2_Parent_Customer_ID" />
                        <SelectField field="Input_#2_Month" selected="False" rename="Input_#2_Month" />
                        <SelectField field="Input_#2_Months_6_to_12" selected="False" />
                        <SelectField field="Input_#3_Product_Group" selected="False" rename="Input_#3_Product_Group" />
                        <SelectField field="Input_#3_Product_Family" selected="False" rename="Input_#3_Product_Family" />
                        <SelectField field="Input_#3_Child_ID" selected="False" rename="Input_#3_Child_ID" />
                        <SelectField field="Input_#3_Parent_Customer_ID" selected="False" rename="Input_#3_Parent_Customer_ID" />
                        <SelectField field="Input_#3_Month" selected="False" rename="Input_#3_Month" />
                        <SelectField field="Input_#3_Months_6_to_12" selected="False" />
                        <SelectField field="*Unknown" selected="True" />
                      </SelectFields>
                    </Configuration>
                  </SelectConfiguration>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxJoinMultiple" />
            </Node>
            <Node ToolID="104">
              <GuiSettings Plugin="AlteryxBasePluginsGui.GenerateRows.GenerateRows">
                <Position x="826" y="564" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <UpdateField value="False" />
                  <UpdateField_Name>Month</UpdateField_Name>
                  <CreateField_Name>Months_6_to_12</CreateField_Name>
                  <CreateField_Type>Date</CreateField_Type>
                  <CreateField_Size>10</CreateField_Size>
                  <Expression_Init>DateTimeAdd([Month],-3,'months')</Expression_Init>
                  <Expression_Cond>[Months_6_to_12]&gt;= datetimeadd([Month],-12,'month')</Expression_Cond>
                  <Expression_Loop>datetimeadd([Months_6_to_12],-1,'month')</Expression_Loop>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxGenerateRows" />
            </Node>
            <Node ToolID="105">
              <GuiSettings Plugin="AlteryxBasePluginsGui.GenerateRows.GenerateRows">
                <Position x="826" y="648" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <UpdateField value="False" />
                  <UpdateField_Name>Month</UpdateField_Name>
                  <CreateField_Name>Months_0_to_6</CreateField_Name>
                  <CreateField_Type>Date</CreateField_Type>
                  <CreateField_Size>10</CreateField_Size>
                  <Expression_Init>[Month]</Expression_Init>
                  <Expression_Cond>[Months_0_to_6]&gt; datetimeadd([Month],-3,'month')</Expression_Cond>
                  <Expression_Loop>datetimeadd([Months_0_to_6],-1,'month')</Expression_Loop>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxGenerateRows" />
            </Node>
            <Node ToolID="106">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Formula.Formula">
                <Position x="730" y="732" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <FormulaFields>
                    <FormulaField expression="1" field="Product_Churn" size="2" type="Int16" />
                  </FormulaFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText><![CDATA[add downgrade flag
]]></AnnotationText>
                  <DefaultAnnotationText><![CDATA[Product_Churn = 1
]]></DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFormula" />
            </Node>
            <Node ToolID="107">
              <GuiSettings Plugin="AlteryxBasePluginsGui.GenerateRows.GenerateRows">
                <Position x="826" y="732" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <UpdateField value="False" />
                  <UpdateField_Name>Month</UpdateField_Name>
                  <CreateField_Name>Months_6_to_12</CreateField_Name>
                  <CreateField_Type>Date</CreateField_Type>
                  <CreateField_Size>10</CreateField_Size>
                  <Expression_Init>DateTimeAdd([Month],-3,'months')</Expression_Init>
                  <Expression_Cond>[Months_6_to_12]&gt;= datetimeadd([Month],-12,'month')</Expression_Cond>
                  <Expression_Loop>datetimeadd([Months_6_to_12],-1,'month')</Expression_Loop>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxGenerateRows" />
            </Node>
            <Node ToolID="108">
              <GuiSettings Plugin="AlteryxBasePluginsGui.GenerateRows.GenerateRows">
                <Position x="826" y="816" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <UpdateField value="False" />
                  <UpdateField_Name>Month</UpdateField_Name>
                  <CreateField_Name>Months_0_to_6</CreateField_Name>
                  <CreateField_Type>Date</CreateField_Type>
                  <CreateField_Size>10</CreateField_Size>
                  <Expression_Init>[Month]</Expression_Init>
                  <Expression_Cond>[Months_0_to_6]&gt; datetimeadd([Month],-3,'month')</Expression_Cond>
                  <Expression_Loop>datetimeadd([Months_0_to_6],-1,'month')</Expression_Loop>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxGenerateRows" />
            </Node>
            <Node ToolID="109">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Union.Union">
                <Position x="994" y="480" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <ByName_ErrorMode>Warning</ByName_ErrorMode>
                  <ByName_OutputMode>All</ByName_OutputMode>
                  <Mode>ByName</Mode>
                  <SetOutputOrder value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxUnion" />
            </Node>
          </ChildNodes>
        </Node>
        <Node ToolID="116">
          <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
            <Position x="1134" y="344" width="505" height="149" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Caption>Find first date in snowball</Caption>
              <Style TextColor="#314c4a" FillColor="#ffff80" BorderColor="#314c4a" Transparency="25" Margin="25" />
              <Disabled value="False" />
              <Folded value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <ChildNodes>
            <Node ToolID="111">
              <GuiSettings Plugin="LockInGui.LockInSummarize.LockInSummarize">
                <Position x="1159" y="393" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Child_ID" action="GroupBy" rename="Child_ID" />
                    <SummarizeField field="Parent_Customer_ID" action="GroupBy" rename="Parent_Customer_ID" />
                    <SummarizeField field="Product_Family" action="GroupBy" rename="Product_Family" />
                    <SummarizeField field="Product_Group" action="GroupBy" rename="Product_Group" />
                    <SummarizeField field="Month" action="Min" rename="Min_Month" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSummarize" />
            </Node>
            <Node ToolID="112">
              <GuiSettings Plugin="LockInGui.LockInJoin.LockInJoin">
                <Position x="1255" y="393" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <JoinMode>INNER</JoinMode>
                  <JoinFields>
                    <JoinInfo connection="Left">
                      <Field field="Child_ID" />
                      <Field field="Parent_Customer_ID" />
                      <Field field="Product_Family" />
                      <Field field="Product_Group" />
                      <Field field="Min_Month" />
                    </JoinInfo>
                    <JoinInfo connection="Right">
                      <Field field="Child_ID" />
                      <Field field="Parent_Customer_ID" />
                      <Field field="Product_Family" />
                      <Field field="Product_Group" />
                      <Field field="Month" />
                    </JoinInfo>
                  </JoinFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText>Inner Join</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInJoin" />
            </Node>
            <Node ToolID="113">
              <GuiSettings Plugin="LockInGui.LockInSelect.LockInSelect">
                <Position x="1363" y="393" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <OrderChanged value="False" />
                  <CommaDecimal value="False" />
                  <SelectFields>
                    <SelectField field="Child_ID" selected="True" />
                    <SelectField field="Parent_Customer_ID" selected="True" />
                    <SelectField field="Product_Family" selected="True" />
                    <SelectField field="Product_Group" selected="True" />
                    <SelectField field="Min_Month" selected="True" rename="First_Date_In_Snowball" />
                    <SelectField field="ARR" selected="True" />
                    <SelectField field="*Unknown" selected="False" />
                  </SelectFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSelect" />
            </Node>
            <Node ToolID="114">
              <GuiSettings Plugin="LockInGui.LockInStreamOut.LockInStreamOut">
                <Position x="1555" y="393" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Sort value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInStreamOut" />
            </Node>
            <Node ToolID="115">
              <GuiSettings Plugin="LockInGui.LockInSummarize.LockInSummarize">
                <Position x="1459" y="393" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Child_ID" action="GroupBy" rename="Child_ID" />
                    <SummarizeField field="Parent_Customer_ID" action="GroupBy" rename="Parent_Customer_ID" />
                    <SummarizeField field="Product_Family" action="GroupBy" rename="Product_Family" />
                    <SummarizeField field="Product_Group" action="GroupBy" rename="Product_Group" />
                    <SummarizeField field="First_Date_In_Snowball" action="GroupBy" rename="First_Date_In_Snowball" />
                    <SummarizeField field="ARR" action="Sum" rename="ARR" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSummarize" />
            </Node>
          </ChildNodes>
        </Node>
        <Node ToolID="130">
          <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
            <Position x="606" y="103" width="1261" height="226" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Caption>Snowball feature creation</Caption>
              <Style TextColor="#314c4a" FillColor="#ffff80" BorderColor="#314c4a" Transparency="25" Margin="25" />
              <Disabled value="False" />
              <Folded value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <ChildNodes>
            <Node ToolID="117">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Formula.Formula">
                <Position x="1495" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <FormulaFields>
                    <FormulaField expression="if [ARR_12mo_ago]&gt;[ARR] then 1 else 0 endif" field="LTM_ARR_Decrease" size="2" type="Int16" />
                    <FormulaField expression="if [ARR_LM]&gt;[ARR] then 1 else 0 endif" field="Monthly_ARR_Decrease" size="2" type="Int16" />
                    <FormulaField expression="[ARR_vs_12mo_ago]/[ARR_12mo_ago]" field="LTM_Delta_ARR_%" size="4" type="Float" />
                    <FormulaField expression="[ARR_vs_LM]/[ARR_LM]" field="Monthly_Delta_ARR_%" size="4" type="Float" />
                    <FormulaField expression="[ARR]-[First_Date_In_Snowball_ARR]" field="First_Date_In_Snowball_Delta_ARR" size="4" type="Float" />
                    <FormulaField expression="([ARR]-[First_Date_In_Snowball_ARR])/[Years_Since_First_Date_In_Snowball]" field="First_Date_In_Snowball_Annual_Delta_ARR" size="4" type="Float" />
                    <FormulaField expression="([ARR]-[First_Date_In_Snowball_ARR])/[First_Date_In_Snowball_ARR]" field="First_Date_In_Snowball_Delta_ARR_%" size="4" type="Float" />
                    <FormulaField expression="pow(([ARR]/[First_Date_In_Snowball_ARR]),(1/[Years_Since_First_Date_In_Snowball])) - 1" field="First_Date_In_Snowball_CAGR_ARR" size="4" type="Float" />
                    <FormulaField expression="([LTM_Delta_Upsell_Organic]+[LTM_Delta_Downsell_Organic])/[ARR_12mo_ago]" field="LTM_Upsell_Downsell_Organic_%_ARR" size="4" type="Float" />
                    <FormulaField expression="([LTM_Delta_Downsell_M&amp;A]+[LTM_Delta_Upsell_M&amp;A])/[ARR_12mo_ago]" field="LTM_Upsell_Downsell_M&amp;A_%_ARR" size="4" type="Float" />
                    <FormulaField expression="([LTM_Delta_Upsell_Organic])/[ARR_12mo_ago]" field="LTM_Upsell_Organic_%_ARR" size="1073741823" type="V_WString" />
                    <FormulaField expression="([LTM_Delta_Downsell_Organic])/[ARR_12mo_ago]" field="LTM_Downsell_Organic_%_ARR" size="1073741823" type="V_WString" />
                  </FormulaFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>calculate deltas and other additional features</AnnotationText>
                  <DefaultAnnotationText>LTM_ARR_Decrease = if [ARR_12mo_ago]&gt;[ARR] then 1 else 0 endif
Monthly_ARR_Decre...</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFormula" />
            </Node>
            <Node ToolID="118">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Formula.Formula">
                <Position x="1399" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <FormulaFields>
                    <FormulaField expression="DateTimeDiff([Month],[First_Date_In_Snowball],'year')" field="Years_Since_First_Date_In_Snowball" size="8" type="Double" />
                    <FormulaField expression="DateTimeDiff([Month],[First_Date_In_Snowball],'month')" field="Months_Since_First_Date_In_Snowball" size="1073741823" type="V_WString" />
                  </FormulaFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>Convert fields to useful format</AnnotationText>
                  <DefaultAnnotationText>Years_Since_First_Date_In_Snowball = DateTimeDiff([Month],[First_Date_In_Snowbal...</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFormula" />
            </Node>
            <Node ToolID="119">
              <GuiSettings Plugin="AlteryxSpatialPluginsGui.Summarize.Summarize">
                <Position x="1591" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Child_ID" action="GroupBy" rename="Child_ID" />
                    <SummarizeField field="Month" action="GroupBy" rename="Month" />
                    <SummarizeField field="ARR" action="Sum" rename="Total_Monthly_Customer_ARR" />
                    <SummarizeField field="Product_Group" action="Count" rename="No_of_Product_Groups" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>Find total number of products and ARR for customer</AnnotationText>
                  <DefaultAnnotationText>Find total number of products and ARR for customer</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxSpatialPluginsEngine.dll" EngineDllEntryPoint="AlteryxSummarize" />
            </Node>
            <Node ToolID="120">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Join.Join">
                <Position x="1687" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration joinByRecordPos="False">
                  <JoinInfo connection="Left">
                    <Field field="Month" />
                    <Field field="Child_ID" />
                  </JoinInfo>
                  <JoinInfo connection="Right">
                    <Field field="Month" />
                    <Field field="Child_ID" />
                  </JoinInfo>
                  <SelectConfiguration>
                    <Configuration outputConnection="Join">
                      <OrderChanged value="False" />
                      <CommaDecimal value="False" />
                      <SelectFields>
                        <SelectField field="Right_Child_ID" selected="False" rename="Right_Child_ID" input="Right_" />
                        <SelectField field="Right_Month" selected="False" rename="Right_Month" input="Right_" />
                        <SelectField field="*Unknown" selected="True" />
                      </SelectFields>
                    </Configuration>
                  </SelectConfiguration>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxJoin" />
            </Node>
            <Node ToolID="121">
              <GuiSettings Plugin="AlteryxBasePluginsGui.MultiFieldFormula.MultiFieldFormula">
                <Position x="1783" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <FieldType>Numeric</FieldType>
                  <Fields orderChanged="False">
                    <Field name="LTM_ARR_Decrease" />
                    <Field name="Monthly_ARR_Decrease" />
                    <Field name="LTM_Delta_ARR_%" />
                    <Field name="Monthly_Delta_ARR_%" />
                    <Field name="First_Date_In_Snowball_Delta_ARR" />
                    <Field name="First_Date_In_Snowball_Annual_Delta_ARR" />
                    <Field name="First_Date_In_Snowball_Delta_ARR_%" />
                    <Field name="First_Date_In_Snowball_CAGR_ARR" />
                    <Field name="LTM_Upsell_Downsell_Organic_%_ARR" />
                    <Field name="LTM_Upsell_Downsell_M&amp;A_%_ARR" />
                    <Field name="Total_Monthly_Customer_ARR" />
                    <Field name="No_of_Product_Groups" />
                    <Field name="*Unknown" />
                    <Field name="ARR" selected="False" />
                    <Field name="ARR_12mo_ago" selected="False" />
                    <Field name="ARR_LM" selected="False" />
                    <Field name="ARR_vs_12mo_ago" selected="False" />
                    <Field name="ARR_vs_LM" selected="False" />
                    <Field name="Customer Cohort Year" selected="False" />
                    <Field name="LTM_Delta_AddAcq" selected="False" />
                    <Field name="LTM_Delta_AddOrg" selected="False" />
                    <Field name="LTM_Delta_Churn" selected="False" />
                    <Field name="LTM_Delta_Cross_Sell_M&amp;A" selected="False" />
                    <Field name="LTM_Delta_Cross_Sell_Organic" selected="False" />
                    <Field name="LTM_Delta_Downgrade" selected="False" />
                    <Field name="LTM_Delta_Downsell_M&amp;A" selected="False" />
                    <Field name="LTM_Delta_Downsell_Organic" selected="False" />
                    <Field name="LTM_Delta_Reoccurring" selected="False" />
                    <Field name="LTM_Delta_Upsell_M&amp;A" selected="False" />
                    <Field name="LTM_Delta_Upsell_Organic" selected="False" />
                    <Field name="LTM_Flag_AddAcq" selected="False" />
                    <Field name="LTM_Flag_AddOrg" selected="False" />
                    <Field name="LTM_Flag_Churn" selected="False" />
                    <Field name="LTM_Flag_Cross_Sell" selected="False" />
                    <Field name="LTM_Flag_Cross_Sell_M&amp;A" selected="False" />
                    <Field name="LTM_Flag_Cross_Sell_Organic" selected="False" />
                    <Field name="LTM_Flag_Downgrade" selected="False" />
                    <Field name="LTM_Flag_Downsell" selected="False" />
                    <Field name="LTM_Flag_Downsell_M&amp;A" selected="False" />
                    <Field name="LTM_Flag_Downsell_organic" selected="False" />
                    <Field name="LTM_Flag_Existing_Customer" selected="False" />
                    <Field name="LTM_Flag_Existing_Product" selected="False" />
                    <Field name="LTM_Flag_Reoccurring" selected="False" />
                    <Field name="LTM_Flag_Upsell" selected="False" />
                    <Field name="LTM_Flag_Upsell_M&amp;A" selected="False" />
                    <Field name="LTM_Flag_Upsell_Organic" selected="False" />
                    <Field name="Monthly_Delta_AddAcq" selected="False" />
                    <Field name="Monthly_Delta_AddOrg" selected="False" />
                    <Field name="Monthly_Delta_Churn" selected="False" />
                    <Field name="Monthly_Delta_Cross_Sell_M&amp;A" selected="False" />
                    <Field name="Monthly_Delta_Cross_Sell_Organic" selected="False" />
                    <Field name="Monthly_Delta_Downgrade" selected="False" />
                    <Field name="Monthly_Delta_Downsell_M&amp;A" selected="False" />
                    <Field name="Monthly_Delta_Downsell_Organic" selected="False" />
                    <Field name="Monthly_Delta_Reoccurring" selected="False" />
                    <Field name="Monthly_Delta_Upsell_M&amp;A" selected="False" />
                    <Field name="Monthly_Delta_Upsell_Organic" selected="False" />
                    <Field name="Monthly_Flag_Add" selected="False" />
                    <Field name="Monthly_Flag_AddAcq" selected="False" />
                    <Field name="Monthly_Flag_AddOrg" selected="False" />
                    <Field name="Monthly_Flag_Churn" selected="False" />
                    <Field name="Monthly_Flag_Cross_Sell" selected="False" />
                    <Field name="Monthly_Flag_Cross_Sell_M&amp;A" selected="False" />
                    <Field name="Monthly_Flag_Cross_Sell_Organic" selected="False" />
                    <Field name="Monthly_Flag_Downgrade" selected="False" />
                    <Field name="Monthly_Flag_Downsell" selected="False" />
                    <Field name="Monthly_Flag_Downsell_M&amp;A" selected="False" />
                    <Field name="Monthly_Flag_Downsell_Organic" selected="False" />
                    <Field name="Monthly_Flag_Existing_Customer" selected="False" />
                    <Field name="Monthly_Flag_Existing_Product" selected="False" />
                    <Field name="Monthly_Flag_Reoccurring" selected="False" />
                    <Field name="Monthly_Flag_Upsell" selected="False" />
                    <Field name="Monthly_Flag_Upsell_M&amp;A" selected="False" />
                    <Field name="Monthly_Flag_Upsell_Organic" selected="False" />
                    <Field name="Product_Lifetime" selected="False" />
                    <Field name="Customer_Or_Product_Churn" selected="False" />
                    <Field name="Customer_Churn" selected="False" />
                    <Field name="Product_Churn" selected="False" />
                    <Field name="First_Date_In_Snowball_ARR" selected="False" />
                    <Field name="Years_Since_First_Date_In_Snowball" selected="False" />
                  </Fields>
                  <CopyOutput value="False" />
                  <Expression>iif(isNull([_CurrentField_]),0,[_CurrentField_])</Expression>
                  <ChangeFieldType value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>fill nulls</AnnotationText>
                  <DefaultAnnotationText>iif(isNull([_CurrentField_]),0,[_CurrentField_])</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxMultiFieldFormula" />
            </Node>
            <Node ToolID="122">
              <GuiSettings Plugin="AlteryxBasePluginsGui.AlteryxSelect.AlteryxSelect">
                <Position x="1303" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <OrderChanged value="False" />
                  <CommaDecimal value="False" />
                  <SelectFields>
                    <SelectField field="Acquisition Date" selected="False" />
                    <SelectField field="*Unknown" selected="True" />
                  </SelectFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxSelect" />
            </Node>
            <Node ToolID="123">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Join.Join">
                <Position x="823" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration joinByRecordPos="False">
                  <JoinInfo connection="Left">
                    <Field field="Month" />
                    <Field field="Parent_Customer_ID" />
                    <Field field="Product_Group" />
                    <Field field="Child_ID" />
                    <Field field="Product_Family" />
                  </JoinInfo>
                  <JoinInfo connection="Right">
                    <Field field="Months_6_to_12" />
                    <Field field="Parent_Customer_ID" />
                    <Field field="Product_Group" />
                    <Field field="Child_ID" />
                    <Field field="Product_Family" />
                  </JoinInfo>
                  <SelectConfiguration>
                    <Configuration outputConnection="Join">
                      <OrderChanged value="False" />
                      <CommaDecimal value="False" />
                      <SelectFields>
                        <SelectField field="Right_Product_Group" selected="False" rename="Right_Product_Group" input="Right_" />
                        <SelectField field="Right_Product_Family" selected="False" rename="Right_Product_Family" input="Right_" />
                        <SelectField field="Right_Child_ID" selected="False" rename="Right_Child_ID" input="Right_" />
                        <SelectField field="Right_Parent_Customer_ID" selected="False" rename="Right_Parent_Customer_ID" input="Right_" />
                        <SelectField field="Right_Months_6_to_12" selected="False" input="Right_" />
                        <SelectField field="Right_Month" selected="False" rename="Right_Month" input="Right_" />
                        <SelectField field="*Unknown" selected="True" />
                      </SelectFields>
                    </Configuration>
                  </SelectConfiguration>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxJoin" />
            </Node>
            <Node ToolID="124">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Union.Union">
                <Position x="919" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <ByName_ErrorMode>Warning</ByName_ErrorMode>
                  <ByName_OutputMode>All</ByName_OutputMode>
                  <Mode>ByName</Mode>
                  <SetOutputOrder value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxUnion" />
            </Node>
            <Node ToolID="125">
              <GuiSettings Plugin="AlteryxSpatialPluginsGui.Summarize.Summarize">
                <Position x="1111" y="153" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="ARR" action="Sum" rename="ARR" />
                    <SummarizeField field="ARR_12mo_ago" action="Sum" rename="ARR_12mo_ago" />
                    <SummarizeField field="ARR_LM" action="Sum" rename="ARR_LM" />
                    <SummarizeField field="ARR_vs_12mo_ago" action="Sum" rename="ARR_vs_12mo_ago" />
                    <SummarizeField field="ARR_vs_LM" action="Sum" rename="ARR_vs_LM" />
                    <SummarizeField field="Child_ID" action="GroupBy" rename="Child_ID" />
                    <SummarizeField field="Customer_Churn" action="Max" rename="Customer_Churn" />
                    <SummarizeField field="Customer_Churn_Month" action="Max" rename="Customer_Churn_Month" />
                    <SummarizeField field="Customer_Or_Product_Churn" action="Max" rename="Customer_Or_Product_Churn" />
                    <SummarizeField field="LTM_Delta_Churn" action="Sum" rename="LTM_Delta_Churn" />
                    <SummarizeField field="LTM_Delta_Cross_Sell_M&amp;A" action="Sum" rename="LTM_Delta_Cross_Sell_M&amp;A" />
                    <SummarizeField field="LTM_Delta_Cross_Sell_Organic" action="Sum" rename="LTM_Delta_Cross_Sell_Organic" />
                    <SummarizeField field="LTM_Delta_Downgrade" action="Sum" rename="LTM_Delta_Downgrade" />
                    <SummarizeField field="LTM_Delta_Downsell_M&amp;A" action="Sum" rename="LTM_Delta_Downsell_M&amp;A" />
                    <SummarizeField field="LTM_Delta_Downsell_Organic" action="Sum" rename="LTM_Delta_Downsell_Organic" />
                    <SummarizeField field="LTM_Delta_Reoccurring" action="Sum" rename="LTM_Delta_Reoccurring" />
                    <SummarizeField field="LTM_Delta_Upsell_M&amp;A" action="Sum" rename="LTM_Delta_Upsell_M&amp;A" />
                    <SummarizeField field="LTM_Delta_Upsell_Organic" action="Sum" rename="LTM_Delta_Upsell_Organic" />
                    <SummarizeField field="LTM_Flag_Churn" action="Max" rename="LTM_Flag_Churn" />
                    <SummarizeField field="LTM_Flag_Cross_Sell" action="Max" rename="LTM_Flag_Cross_Sell" />
                    <SummarizeField field="LTM_Flag_Cross_Sell_M&amp;A" action="Max" rename="LTM_Flag_Cross_Sell_M&amp;A" />
                    <SummarizeField field="LTM_Flag_Cross_Sell_Organic" action="Max" rename="LTM_Flag_Cross_Sell_Organic" />
                    <SummarizeField field="LTM_Flag_Downgrade" action="Max" rename="LTM_Flag_Downgrade" />
                    <SummarizeField field="LTM_Flag_Downsell" action="Max" rename="LTM_Flag_Downsell" />
                    <SummarizeField field="LTM_Flag_Downsell_M&amp;A" action="Max" rename="LTM_Flag_Downsell_M&amp;A" />
                    <SummarizeField field="LTM_Flag_Downsell_organic" action="Max" rename="LTM_Flag_Downsell_organic" />
                    <SummarizeField field="LTM_Flag_Existing_Customer" action="Max" rename="LTM_Flag_Existing_Customer" />
                    <SummarizeField field="LTM_Flag_Existing_Product" action="Max" rename="LTM_Flag_Existing_Product" />
                    <SummarizeField field="LTM_Flag_Upsell" action="Max" rename="LTM_Flag_Upsell" />
                    <SummarizeField field="LTM_Flag_Upsell_M&amp;A" action="Max" rename="LTM_Flag_Upsell_M&amp;A" />
                    <SummarizeField field="LTM_Flag_Upsell_Organic" action="Max" rename="LTM_Flag_Upsell_Organic" />
                    <SummarizeField field="Month" action="GroupBy" rename="Month" />
                    <SummarizeField field="Monthly_Delta_Churn" action="Sum" rename="Monthly_Delta_Churn" />
                    <SummarizeField field="Monthly_Delta_Cross_Sell_M&amp;A" action="Sum" rename="Monthly_Delta_Cross_Sell_M&amp;A" />
                    <SummarizeField field="Monthly_Delta_Cross_Sell_Organic" action="Sum" rename="Monthly_Delta_Cross_Sell_Organic" />
                    <SummarizeField field="Monthly_Delta_Downgrade" action="Sum" rename="Monthly_Delta_Downgrade" />
                    <SummarizeField field="Monthly_Delta_Downsell_M&amp;A" action="Sum" rename="Monthly_Delta_Downsell_M&amp;A" />
                    <SummarizeField field="Monthly_Delta_Downsell_Organic" action="Sum" rename="Monthly_Delta_Downsell_Organic" />
                    <SummarizeField field="Monthly_Delta_Reoccurring" action="Sum" rename="Monthly_Delta_Reoccurring" />
                    <SummarizeField field="Monthly_Delta_Upsell_M&amp;A" action="Sum" rename="Monthly_Delta_Upsell_M&amp;A" />
                    <SummarizeField field="Monthly_Delta_Upsell_Organic" action="Sum" rename="Monthly_Delta_Upsell_Organic" />
                    <SummarizeField field="Monthly_Flag_Add" action="Max" rename="Monthly_Flag_Add" />
                    <SummarizeField field="Monthly_Flag_Churn" action="Max" rename="Monthly_Flag_Churn" />
                    <SummarizeField field="Monthly_Flag_Cross_Sell" action="Max" rename="Monthly_Flag_Cross_Sell" />
                    <SummarizeField field="Monthly_Flag_Cross_Sell_M&amp;A" action="Max" rename="Monthly_Flag_Cross_Sell_M&amp;A" />
                    <SummarizeField field="Monthly_Flag_Cross_Sell_Organic" action="Max" rename="Monthly_Flag_Cross_Sell_Organic" />
                    <SummarizeField field="Monthly_Flag_Downgrade" action="Max" rename="Monthly_Flag_Downgrade" />
                    <SummarizeField field="Monthly_Flag_Downsell" action="Max" rename="Monthly_Flag_Downsell" />
                    <SummarizeField field="Monthly_Flag_Downsell_M&amp;A" action="Max" rename="Monthly_Flag_Downsell_M&amp;A" />
                    <SummarizeField field="Monthly_Flag_Downsell_Organic" action="Max" rename="Monthly_Flag_Downsell_Organic" />
                    <SummarizeField field="Monthly_Flag_Existing_Customer" action="Max" rename="Monthly_Flag_Existing_Customer" />
                    <SummarizeField field="Monthly_Flag_Existing_Product" action="Max" rename="Monthly_Flag_Existing_Product" />
                    <SummarizeField field="Monthly_Flag_Upsell" action="Max" rename="Monthly_Flag_Upsell" />
                    <SummarizeField field="Monthly_Flag_Upsell_M&amp;A" action="Max" rename="Monthly_Flag_Upsell_M&amp;A" />
                    <SummarizeField field="Monthly_Flag_Upsell_Organic" action="Max" rename="Monthly_Flag_Upsell_Organic" />
                    <SummarizeField field="Parent_Customer_ID" action="GroupBy" rename="Parent_Customer_ID" />
                    <SummarizeField field="Product_Churn" action="Max" rename="Product_Churn" />
                    <SummarizeField field="Product_Family" action="GroupBy" rename="Product_Family" />
                    <SummarizeField field="Product_Group" action="GroupBy" rename="Product_Group" />
                    <SummarizeField field="Product_Join_Month" action="Min" rename="Product_Join_Month" />
                    <SummarizeField field="Product_Lifetime" action="Max" rename="Product_Lifetime" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>Summarise to parent/child/product group/product family/month level</AnnotationText>
                  <DefaultAnnotationText>Summarise to parent/child/product group/product family/month level</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxSpatialPluginsEngine.dll" EngineDllEntryPoint="AlteryxSummarize" />
            </Node>
            <Node ToolID="126">
              <GuiSettings Plugin="AlteryxBasePluginsGui.MultiFieldFormula.MultiFieldFormula">
                <Position x="1015" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <FieldType>Numeric</FieldType>
                  <Fields orderChanged="False">
                    <Field name="Customer_Or_Product_Churn" />
                    <Field name="Customer_Churn" />
                    <Field name="Product_Churn" />
                    <Field name="Employee_Size" selected="False" />
                    <Field name="Acquisition_Flag" selected="False" />
                    <Field name="Is_Recurring" selected="False" />
                    <Field name="Is_SaaS_Product" selected="False" />
                    <Field name="Is_Cloud_Product" selected="False" />
                    <Field name="Is_Upsell_Product" selected="False" />
                    <Field name="Product_Acquired_Flag" selected="False" />
                    <Field name="Product_Lifetime" selected="False" />
                    <Field name="ARR" selected="False" />
                    <Field name="ARR_LM" selected="False" />
                    <Field name="ARR_LY" selected="False" />
                    <Field name="ARR_vs_LM" selected="False" />
                    <Field name="ARR_vs_LY" selected="False" />
                    <Field name="Monthly_Delta_Churn" selected="False" />
                    <Field name="Monthly_Delta_Add_Organic" selected="False" />
                    <Field name="Monthly_Delta_Add_M&amp;A" selected="False" />
                    <Field name="Monthly_Delta_Cross_Sell_Organic" selected="False" />
                    <Field name="Monthly_Delta_Cross_Sell_M&amp;A" selected="False" />
                    <Field name="Monthly_Delta_Upsell_Organic" selected="False" />
                    <Field name="Monthly_Delta_Upsell_M&amp;A" selected="False" />
                    <Field name="Monthly_Delta_Downsell_Organic" selected="False" />
                    <Field name="Monthly_Delta_Downsell_M&amp;A" selected="False" />
                    <Field name="Monthly_Delta_Downgrade" selected="False" />
                    <Field name="LTM_Delta_Churn" selected="False" />
                    <Field name="LTM_Delta_Add_Organic" selected="False" />
                    <Field name="LTM_Delta_Add_M&amp;A" selected="False" />
                    <Field name="LTM_Delta_Cross_Sell_Organic" selected="False" />
                    <Field name="LTM_Delta_Cross_Sell_M&amp;A" selected="False" />
                    <Field name="LTM_Delta_Upsell_Organic" selected="False" />
                    <Field name="LTM_Delta_Upsell_M&amp;A" selected="False" />
                    <Field name="LTM_Delta_Downsell_Organic" selected="False" />
                    <Field name="LTM_Delta_Downsell_M&amp;A" selected="False" />
                    <Field name="LTM_Delta_Downgrade" selected="False" />
                    <Field name="Monthly_Flag_Existing_Customer" selected="False" />
                    <Field name="Monthly_Flag_Existing_Product" selected="False" />
                    <Field name="Monthly_Flag_Churn" selected="False" />
                    <Field name="Monthly_Flag_Add" selected="False" />
                    <Field name="Monthly_Flag_Add_Organic" selected="False" />
                    <Field name="Monthly_Flag_Add_M&amp;A" selected="False" />
                    <Field name="Monthly_Flag_Cross_Sell" selected="False" />
                    <Field name="Monthly_Flag_Cross_Sell_Organic" selected="False" />
                    <Field name="Monthly_Flag_Cross_Sell_M&amp;A" selected="False" />
                    <Field name="Monthly_Flag_Upsell" selected="False" />
                    <Field name="Monthly_Flag_Upsell_Organic" selected="False" />
                    <Field name="Monthly_Flag_Upsell_M&amp;A" selected="False" />
                    <Field name="Monthly_Flag_Downsell" selected="False" />
                    <Field name="Monthly_Flag_Downsell_Organic" selected="False" />
                    <Field name="Monthly_Flag_Downsell_M&amp;A" selected="False" />
                    <Field name="Monthly_Flag_Downgrade" selected="False" />
                    <Field name="LTM_Flag_Existing_Customer" selected="False" />
                    <Field name="LTM_Flag_Existing_Product" selected="False" />
                    <Field name="LTM_Flag_Churn" selected="False" />
                    <Field name="LTM_Flag_Add" selected="False" />
                    <Field name="LTM_Flag_Add_Organic" selected="False" />
                    <Field name="LTM_Flag_Add_M&amp;A" selected="False" />
                    <Field name="LTM_Flag_Cross_Sell" selected="False" />
                    <Field name="LTM_Flag_Cross_Sell_Organic" selected="False" />
                    <Field name="LTM_Flag_Cross_Sell_M&amp;A" selected="False" />
                    <Field name="LTM_Flag_Upsell" selected="False" />
                    <Field name="LTM_Flag_Upsell_Organic" selected="False" />
                    <Field name="LTM_Flag_Upsell_M&amp;A" selected="False" />
                    <Field name="LTM_Flag_Downsell" selected="False" />
                    <Field name="LTM_Flag_Downsell_Organic" selected="False" />
                    <Field name="LTM_Flag_Downsell_M&amp;A" selected="False" />
                    <Field name="LTM_Flag_Downgrade" selected="False" />
                    <Field name="Non_Recurring_Revenue" selected="False" />
                    <Field name="LTM_Delta_Price_Change" selected="False" />
                    <Field name="LTM_Delta_Reoccurring" selected="False" />
                    <Field name="LTM_Delta_Volume_Change" selected="False" />
                    <Field name="Monthly_ARR_Down" selected="False" />
                    <Field name="Monthly_ARR_Up" selected="False" />
                    <Field name="Monthly_Check_Delta" selected="False" />
                    <Field name="Monthly_Delta_Price_Change" selected="False" />
                    <Field name="Monthly_Delta_Reoccurring" selected="False" />
                    <Field name="Monthly_Delta_Volume_Change" selected="False" />
                    <Field name="Pre_Acquisition_Revenue_Flag" selected="False" />
                    <Field name="Use_Reoccur_Logic" selected="False" />
                    <Field name="Yearly_ARR_Down" selected="False" />
                    <Field name="Yearly_ARR_Up" selected="False" />
                    <Field name="Yearly_Check_Delta" selected="False" />
                    <Field name="ARR_12mo_ago" selected="False" />
                    <Field name="ARR_vs_12mo_ago" selected="False" />
                    <Field name="*Unknown" selected="False" />
                  </Fields>
                  <CopyOutput value="False" />
                  <Expression>iif(isNull([_CurrentField_]),0,[_CurrentField_])</Expression>
                  <ChangeFieldType value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>fill nulls</AnnotationText>
                  <DefaultAnnotationText>iif(isNull([_CurrentField_]),0,[_CurrentField_])</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxMultiFieldFormula" />
            </Node>
            <Node ToolID="127">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Join.Join">
                <Position x="727" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration joinByRecordPos="False">
                  <JoinInfo connection="Left">
                    <Field field="Child_ID" />
                    <Field field="Month" />
                    <Field field="Parent_Customer_ID" />
                    <Field field="Product_Family" />
                    <Field field="Product_Group" />
                  </JoinInfo>
                  <JoinInfo connection="Right">
                    <Field field="Child_ID" />
                    <Field field="Months_0_to_6" />
                    <Field field="Parent_Customer_ID" />
                    <Field field="Product_Family" />
                    <Field field="Product_Group" />
                  </JoinInfo>
                  <SelectConfiguration>
                    <Configuration outputConnection="Join">
                      <OrderChanged value="False" />
                      <CommaDecimal value="False" />
                      <SelectFields>
                        <SelectField field="Right_Product_Group" selected="True" rename="Right_Product_Group" input="Right_" />
                        <SelectField field="Right_Product_Family" selected="True" rename="Right_Product_Family" input="Right_" />
                        <SelectField field="Right_Child_ID" selected="True" rename="Right_Child_ID" input="Right_" />
                        <SelectField field="Right_Parent_Customer_ID" selected="True" rename="Right_Parent_Customer_ID" input="Right_" />
                        <SelectField field="Right_Month" selected="True" rename="Right_Month" input="Right_" />
                        <SelectField field="*Unknown" selected="True" />
                      </SelectFields>
                    </Configuration>
                  </SelectConfiguration>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>Take left of join to remove entries within 3 months of churn or downgrade</AnnotationText>
                  <DefaultAnnotationText>Take left of join to remove entries within 3 months of churn or downgrade</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxJoin" />
            </Node>
            <Node ToolID="128">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Filter.Filter">
                <Position x="631" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Expression>datetimeyear([Month]) &gt;= 2018</Expression>
                  <Mode>Custom</Mode>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <AnnotationText>filter out pre-2018</AnnotationText>
                  <DefaultAnnotationText>datetimeyear([Month]) &gt;= 2018</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFilter" />
            </Node>
            <Node ToolID="129">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Join.Join">
                <Position x="1207" y="152" />
              </GuiSettings>
              <Properties>
                <Configuration joinByRecordPos="False">
                  <JoinInfo connection="Left">
                    <Field field="Child_ID" />
                    <Field field="Parent_Customer_ID" />
                    <Field field="Product_Group" />
                    <Field field="Product_Family" />
                  </JoinInfo>
                  <JoinInfo connection="Right">
                    <Field field="Child_ID" />
                    <Field field="Parent_Customer_ID" />
                    <Field field="Product_Group" />
                    <Field field="Product_Family" />
                  </JoinInfo>
                  <SelectConfiguration>
                    <Configuration outputConnection="Join">
                      <OrderChanged value="False" />
                      <CommaDecimal value="False" />
                      <SelectFields>
                        <SelectField field="Right_Child_ID" selected="False" rename="Right_Child_ID" input="Right_" />
                        <SelectField field="Right_Parent_Customer_ID" selected="False" rename="Right_Parent_Customer_ID" input="Right_" />
                        <SelectField field="Right_Product_Family" selected="False" rename="Right_Product_Family" input="Right_" />
                        <SelectField field="Right_Product_Group" selected="False" rename="Right_Product_Group" input="Right_" />
                        <SelectField field="Right_ARR" selected="True" rename="First_Date_In_Snowball_ARR" input="Right_" />
                        <SelectField field="Right_Month" selected="False" rename="Right_Month" input="Right_" />
                        <SelectField field="*Unknown" selected="True" />
                      </SelectFields>
                    </Configuration>
                  </SelectConfiguration>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxJoin" />
            </Node>
          </ChildNodes>
        </Node>
      </ChildNodes>
    </Node>
    <Node ToolID="54">
      <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
        <Position x="67" y="1582" width="1036" height="512" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Caption>Checks</Caption>
          <Style TextColor="#314c4a" FillColor="#ecf2f2" BorderColor="#314c4a" Transparency="25" Margin="25" />
          <Disabled value="True" />
          <Folded value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <ChildNodes>
        <Node ToolID="52">
          <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
            <Position x="705" y="1859" width="373" height="149" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Caption>Check full outer join</Caption>
              <Style TextColor="#314c4a" FillColor="#ecf2f2" BorderColor="#314c4a" Transparency="25" Margin="25" />
              <Disabled value="True" />
              <Folded value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <ChildNodes>
            <Node ToolID="35">
              <GuiSettings Plugin="LockInGui.LockInSummarize.LockInSummarize">
                <Position x="814" y="1908" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Parent_ID" action="GroupBy" rename="Parent_ID" />
                    <SummarizeField field="Child_ID" action="GroupBy" rename="Child_ID" />
                    <SummarizeField field="Product_Family" action="GroupBy" rename="Product_Family" />
                    <SummarizeField field="Product_Group" action="GroupBy" rename="Product_Group" />
                    <SummarizeField field="R_Month" action="GroupBy" rename="R_Month" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSummarize" />
            </Node>
            <Node ToolID="36">
              <GuiSettings Plugin="LockInGui.LockInSummarize.LockInSummarize">
                <Position x="898" y="1908" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Parent_ID" action="Count" rename="Count" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSummarize" />
            </Node>
            <Node ToolID="37">
              <GuiSettings Plugin="LockInGui.LockInStreamOut.LockInStreamOut">
                <Position x="994" y="1908" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Sort value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInStreamOut" />
            </Node>
            <Node ToolID="26">
              <GuiSettings Plugin="LockInGui.LockInJoin.LockInJoin">
                <Position x="730" y="1908" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <JoinMode>FULL</JoinMode>
                  <JoinFields>
                    <JoinInfo connection="Left">
                      <Field field="Parent customer ID" />
                    </JoinInfo>
                    <JoinInfo connection="Right">
                      <Field field="Parent_ID" />
                    </JoinInfo>
                  </JoinFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText>Full Outer Join</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInJoin" />
            </Node>
          </ChildNodes>
        </Node>
        <Node ToolID="50">
          <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
            <Position x="92" y="1631" width="571" height="438" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Caption>Checks on snowball granualrity</Caption>
              <Style TextColor="#314c4a" FillColor="#ecf2f2" BorderColor="#314c4a" Transparency="25" Margin="25" />
              <Disabled value="True" />
              <Folded value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <ChildNodes>
            <Node ToolID="28">
              <GuiSettings Plugin="LockInGui.LockInSummarize.LockInSummarize">
                <Position x="117" y="1680" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Parent_ID" action="GroupBy" rename="Parent_ID" />
                    <SummarizeField field="Child_ID" action="GroupBy" rename="Child_ID" />
                    <SummarizeField field="Product_Family" action="GroupBy" rename="Product_Family" />
                    <SummarizeField field="Product_Group" action="GroupBy" rename="Product_Group" />
                    <SummarizeField field="Month" action="GroupBy" rename="Month" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSummarize" />
            </Node>
            <Node ToolID="29">
              <GuiSettings Plugin="LockInGui.LockInSummarize.LockInSummarize">
                <Position x="129" y="1764" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="System" action="Count" rename="Count" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSummarize" />
            </Node>
            <Node ToolID="30">
              <GuiSettings Plugin="LockInGui.LockInSummarize.LockInSummarize">
                <Position x="214" y="1680" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Parent_ID" action="Count" rename="Count" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSummarize" />
            </Node>
            <Node ToolID="31">
              <GuiSettings Plugin="LockInGui.LockInStreamOut.LockInStreamOut">
                <Position x="286" y="1680" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Sort value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInStreamOut" />
            </Node>
            <Node ToolID="32">
              <GuiSettings Plugin="LockInGui.LockInStreamOut.LockInStreamOut">
                <Position x="226" y="1764" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Sort value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInStreamOut" />
            </Node>
            <Node ToolID="44">
              <GuiSettings Plugin="LockInGui.LockInSummarize.LockInSummarize">
                <Position x="118" y="1860" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Parent_ID" action="GroupBy" rename="Parent_ID" />
                    <SummarizeField field="Child_ID" action="GroupBy" rename="Child_ID" />
                    <SummarizeField field="Product_Family" action="GroupBy" rename="Product_Family" />
                    <SummarizeField field="Product_Group" action="GroupBy" rename="Product_Group" />
                    <SummarizeField field="Month" action="GroupBy" rename="Month" />
                    <SummarizeField field="System" action="Count" rename="Count" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSummarize" />
            </Node>
            <Node ToolID="45">
              <GuiSettings Plugin="LockInGui.LockInFilter.LockInFilter">
                <Position x="202" y="1872" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Mode>Simple</Mode>
                  <Simple>
                    <Field>Count</Field>
                    <Operator>&gt;</Operator>
                    <Operands>
                      <Operand>1</Operand>
                    </Operands>
                  </Simple>
                  <ValidateBeforeRun value="True" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText>"Count" &gt; 1</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInFilter" />
            </Node>
            <Node ToolID="46">
              <GuiSettings Plugin="LockInGui.LockInJoin.LockInJoin">
                <Position x="346" y="1848" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <JoinMode>INNER</JoinMode>
                  <JoinFields>
                    <JoinInfo connection="Left">
                      <Field field="Parent_ID" />
                      <Field field="Child_ID" />
                      <Field field="Product_Family" />
                      <Field field="Product_Group" />
                      <Field field="Month" />
                    </JoinInfo>
                    <JoinInfo connection="Right">
                      <Field field="Parent_ID" />
                      <Field field="Child_ID" />
                      <Field field="Product_Family" />
                      <Field field="Product_Group" />
                      <Field field="Month" />
                    </JoinInfo>
                  </JoinFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText>Inner Join</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInJoin" />
            </Node>
            <Node ToolID="47">
              <GuiSettings Plugin="LockInGui.LockInStreamOut.LockInStreamOut">
                <Position x="430" y="1848" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Sort value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInStreamOut" />
            </Node>
            <Node ToolID="48">
              <GuiSettings Plugin="AlteryxBasePluginsGui.Sort.Sort">
                <Position x="538" y="1848" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SortInfo locale="1033">
                    <Field field="Parent_ID" order="Ascending" />
                    <Field field="Child_ID" order="Ascending" />
                    <Field field="Product_Family" order="Ascending" />
                    <Field field="Product_Group" order="Ascending" />
                    <Field field="Month" order="Ascending" />
                  </SortInfo>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText>Parent_ID - Ascending
Child_ID - Ascending
Product_Family - Ascending
Product_Group - Ascending
...</DefaultAnnotationText>
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxSort" />
            </Node>
          </ChildNodes>
        </Node>
        <Node ToolID="51">
          <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
            <Position x="705" y="1631" width="301" height="217" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Caption>Check customer 360 granularity</Caption>
              <Style TextColor="#314c4a" FillColor="#ecf2f2" BorderColor="#314c4a" Transparency="25" Margin="25" />
              <Disabled value="True" />
              <Folded value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <ChildNodes>
            <Node ToolID="40">
              <GuiSettings Plugin="LockInGui.LockInSummarize.LockInSummarize">
                <Position x="730" y="1764" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Parent customer ID" action="GroupBy" rename="Parent customer ID" />
                    <SummarizeField field="Month" action="GroupBy" rename="Month" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSummarize" />
            </Node>
            <Node ToolID="41">
              <GuiSettings Plugin="LockInGui.LockInSummarize.LockInSummarize">
                <Position x="838" y="1764" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Parent customer ID" action="Count" rename="Count" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSummarize" />
            </Node>
            <Node ToolID="43">
              <GuiSettings Plugin="LockInGui.LockInStreamOut.LockInStreamOut">
                <Position x="922" y="1752" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Sort value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInStreamOut" />
            </Node>
            <Node ToolID="42">
              <GuiSettings Plugin="LockInGui.LockInStreamOut.LockInStreamOut">
                <Position x="862" y="1680" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <Sort value="False" />
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInStreamOut" />
            </Node>
            <Node ToolID="39">
              <GuiSettings Plugin="LockInGui.LockInSummarize.LockInSummarize">
                <Position x="742" y="1680" />
              </GuiSettings>
              <Properties>
                <Configuration>
                  <SummarizeFields>
                    <SummarizeField field="Time stamp" action="Count" rename="Count" />
                  </SummarizeFields>
                </Configuration>
                <Annotation DisplayMode="0">
                  <Name />
                  <DefaultAnnotationText />
                  <Left value="False" />
                </Annotation>
              </Properties>
              <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSummarize" />
            </Node>
          </ChildNodes>
        </Node>
      </ChildNodes>
    </Node>
    <Node ToolID="23">
      <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
        <Position x="2190" y="116" width="493" height="333" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Caption>Train model</Caption>
          <Style TextColor="#314c4a" FillColor="#ecf2f2" BorderColor="#314c4a" Transparency="25" Margin="25" />
          <Disabled value="False" />
          <Folded value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <ChildNodes>
        <Node ToolID="4">
          <GuiSettings Plugin="AlteryxBasePluginsGui.TextInput.TextInput">
            <Position x="2215" y="332" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <NumRows value="1" />
              <Fields>
                <Field name="Test" />
              </Fields>
              <Data>
                <r>
                  <c>test</c>
                </r>
              </Data>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <AnnotationText>dummy input</AnnotationText>
              <DefaultAnnotationText>dummy input</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxTextInput" />
        </Node>
        <Node ToolID="5">
          <GuiSettings Plugin="AlteryxBasePluginsGui.Formula.Formula">
            <Position x="2359" y="333" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <FormulaFields>
                <FormulaField expression="[Engine.WorkflowDirectory]" field="WorkflowPath_" size="1073741823" type="V_WString" />
              </FormulaFields>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <AnnotationText><![CDATA[Create path for inputs
]]></AnnotationText>
              <DefaultAnnotationText><![CDATA[WorkflowPath_ = [Engine.WorkflowDirectory]
]]></DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFormula" />
        </Node>
        <Node ToolID="8">
          <GuiSettings Plugin="JupyterCode">
            <Position x="2599" y="177" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <WorkflowName>c:\users\public\churn prediction\phase 2\hcm alteryx workflows\master - hcm model retrain.yxmd</WorkflowName>
              <JupyterProduction>false</JupyterProduction>
              <vEnvName>designerbasetools_venv</vEnvName>
              <DefaultVenv>1</DefaultVenv>
              <productionModeScript>#################################
# standard imports

import pickle
import pandas as pd
import numpy as np
from math import exp
from tqdm import tqdm

import scipy.stats as stats

# alteryx imports
from ayx import Package
from ayx import Alteryx


#################################
# non standard imports

packages = ['catboost'] # non standard packages that might need installing

from ayx import Package
Package.installPackages(packages)

print("Installation of required packages is complete.")




#################################
from catboost import CatBoostClassifier
from sklearn.calibration import _CalibratedClassifier, CalibratedClassifierCV
from sklearn.isotonic import IsotonicRegression
from sklearn.metrics import roc_auc_score
from sklearn.model_selection import train_test_split


#################################
# imports from the workflow

df_feature_matrix = Alteryx.read('#1')

file_path = Alteryx.read('#2')


#################################
# define classes

class ColumnHeaders:

    def __init__(self, df_feature_matrix=None):

        self.product_family = 'Product_Family'
        self.month = 'Month'
        self.parent_id = 'Parent_Customer_ID'
        self.product_group = 'Product_Group'
        self.child_id = 'Child_ID'
        self.customer_or_product_churn = 'Customer_Or_Product_Churn'
        self.customer_churn = 'Customer_Churn'
        self.product_churn = 'Product_Churn'
        self.churn_probability = 'churn_probability'
        self.list_id_vars = [self.product_family,
                             self.product_group,
                             self.parent_id,
                             self.child_id,
                             self.month]

        self.list_id_vars_not_cat = [self.parent_id,
                                     self.child_id,
                                     self.month,
                                     self.product_group]

        list_not_cat_var_dont_ohe = [self.parent_id,
                                     self.product_group,
                                     self.child_id,
                                     self.month,
                                     'Acquisition Date',
                                     'Month_Plus_1_Year',
                                     'Month_Plus_6_Months',
                                     'Month_Plus_3_Months',
                                     'Customer_Churn_Month',
                                     'Product_Join_Month',
                                     'First_Date_In_Snowball',
                                     'Month_Plus_2_Years',
                                     'Right_Month_Minus_1_Year',
                                     'Headquarters',
                                     'Region',
                                     'Specialties',
                                     'Industry',
                                     'indus']

        self.dict_label_encode = {'Company_size': {'0-1 employees': 1,
                                                   '2-10 employees': 2,
                                                   '11-50 employees': 3,
                                                   '51-200 employees': 4,
                                                   '201-500 employees': 5,
                                                   '501-1,000 employees': 6,
                                                   '1,001-5,000 employees': 7,
                                                   '5,001-10,000 employees': 8,
                                                   '10,001+ employees': 9},
                                  'NPS_Classification': {'Neutral': 1,
                                                         'Promoter': 2,
                                                         'Detractor': 0}}

        self.list_churn_flags = [self.customer_churn,
                                 self.product_churn,
                                 self.customer_or_product_churn]

        self.list_features_to_exclude = ['Years_Since_First_Date_In_Snowball',
                                         'Months_Since_First_Date_In_Snowball',
                                         'First_Date_In_Snowball_ARR',
                                         'Product_Lifetime']

        if df_feature_matrix is not None:
            self.list_feature_and_target_columns = [column for column in df_feature_matrix.columns if
                                                    column not in self.list_id_vars_not_cat
                                                    and column not in self.list_features_to_exclude]

        self.list_categorical_variables = []
        self.list_categorical_variables_OHE = []
        self.list_categorical_variables_label_encode = []
        self.list_numerical_variables = []

        if df_feature_matrix is not None:
            for column in self.list_feature_and_target_columns:

                # not a target variable of intentionally excluded
                if column not in self.list_churn_flags:
                    datatype = df_feature_matrix[column].dtype
                    count_distinct = len(df_feature_matrix[column].unique())

                    if count_distinct == 2 or datatype in [str, object] and column not in list_not_cat_var_dont_ohe:
                        self.list_categorical_variables.append(column)

                        if count_distinct &gt; 2 and datatype in [str, object] and column not in self.dict_label_encode:
                            self.list_categorical_variables_OHE.append(column)

                            if count_distinct &gt; 5:
                                print(f'Warning, OHE for {column} may create too many columns,'
                                      f' {count_distinct} unique values')

                        else:
                            self.list_categorical_variables_label_encode.append(column)

                    elif datatype in [float, int] + [f'int{x}' for x in [16,32,64]] + [f'Int{x}' for x in [16,32,64]]:
                        self.list_numerical_variables.append(column)

                    elif column not in list_not_cat_var_dont_ohe:
                        print(
                            f'!!! {column} not added to variable list, dtype: {datatype}, count distinct: {count_distinct}')


class ModelConfig:
    def __init__(self):
        col = ColumnHeaders()

        # model settings
        self.target_col = col.customer_or_product_churn
        self.latest_feature_list = ['First_Date_In_Snowball_Delta_ARR_%',
                                    'Monthly_Delta_ARR_%',
                                    'L12M_Credit_Note_Count',
                                    'LTM_Flag_Downsell_organic',
                                    'LTM_Delta_Upsell_Organic',
                                    'L12M_Interactions_Change',
                                    'L12M_Delta_Usage_%',
                                    'Avg_Time_To_Agree_Renewal_in_Months',
                                    'Customer_Discount_%_of_ARR',
                                    'L3M_Ticket_Resolution_Time_Green',
                                    'L3M_Increase_in_Ticket_Count',
                                    'L12M Escalation Flag',
                                    'L12M_Avg_NPS_Score']

        self.dict_winsorize_thresholds = {'L3M_Ticket_Resolution_Time_Green': 0.10,
                                          'L12M_Delta_Usage_%': 0.005,
                                          'LTM_Delta_Upsell_Organic': 0.005,
                                          'First_Date_In_Snowball_Delta_ARR_%': 0.05,
                                          'L12M_Interactions_Change': 0.05,
                                          'Monthly_Delta_ARR_%': 0.005,
                                          'Avg_Time_To_Agree_Renewal_in_Months': 0.01,
                                          'Customer_Discount_%_of_ARR': 0.005}

        # hyper-params
        self.class_weights = {0: 1,
                              1: 12}  # weight incorrect classification of churn 12x higher
        
        self.dict_hyperparams = {'iterations': 500,
                                 'verbose': False,
                                 'eval_metric': 'AUC',
                                 'class_weights': self.class_weights,
                                 # logloss for 2-class classification
                                 'loss_function': 'Logloss',
                                 # built in facility to prevent overfitting
                                 'use_best_model': True,
                                 # limit the number of splits by feature
                                 'border_count': 40}

        # modelling adjustments
        self.test_split = 0.2
        self.rand_state = 0




#################################
# define constants

model_config = ModelConfig()

# filter to include as many months as possible where we know churn has happened (3-12 months out)
last_month_for_training = str((pd.to_datetime(df_feature_matrix['Month'].max()) - pd.DateOffset(months=12)).date())
first_month_for_training = '2019-09-01'  # fixed for now due to keeping at similar churn levels
condition_training_data = (df_feature_matrix['Month'] &lt;= last_month_for_training) &amp; (
        df_feature_matrix['Month'] &gt;= first_month_for_training)
df_feature_matrix = df_feature_matrix[condition_training_data]

col = ColumnHeaders(df_feature_matrix)

list_features = model_config.latest_feature_list


#################################
# define test-train split function

def split_data_into_test_train_wrapper(df_feature_matrix,
                                       unique_variable=col.parent_id,
                                       test_split=model_config.test_split,
                                       rand_state=model_config.rand_state,
                                       split_target_evenly=True):
    def split_data_set_into_test_train(df_feature_matrix=df_feature_matrix,
                                       unique_variable=unique_variable,
                                       test_split=test_split,
                                       rand_state=rand_state):
        """
        Split the dataset into a test-train set based on a specific unique variable.
        This is needed to avoid falsely inflating the accuracy if e.g. there are several observations for the same customer
        :param df_feature_matrix:
        :param target_variable:
        :param unique_variable:
        :param test_split:
        :return:
        """
        df_unique = df_feature_matrix.drop_duplicates(subset=unique_variable)

        df_train_unique, df_test_unique = train_test_split(df_unique, test_size=test_split, random_state=rand_state)

        list_train_unique = df_train_unique[unique_variable].to_list()
        list_test_unique = df_test_unique[unique_variable].to_list()

        df_features_train = df_feature_matrix[
            df_feature_matrix[unique_variable].isin(list_train_unique)]
        df_features_test = df_feature_matrix[df_feature_matrix[unique_variable].isin(list_test_unique)]

        return df_features_train, df_features_test

    if split_target_evenly:
        # need to keep churn split fairly similar across test and train to avoid skew
        # make sure a customer is still only in one set
        list_churned_customers = [*df_feature_matrix[df_feature_matrix[model_config.target_col] == 1][
            unique_variable].unique()]

        df_feature_matrix_churn = df_feature_matrix[df_feature_matrix[unique_variable].isin(list_churned_customers)]
        df_feature_matrix_not_churn = df_feature_matrix[
            ~df_feature_matrix[unique_variable].isin(list_churned_customers)]

        df_train_churn, df_test_churn = split_data_set_into_test_train(df_feature_matrix_churn)
        df_train_not_churn, df_test_not_churn = split_data_set_into_test_train(df_feature_matrix_not_churn)

        df_train = df_train_churn.append(df_train_not_churn)
        df_test = df_test_churn.append(df_test_not_churn)
    else:
        df_train, df_test = split_data_set_into_test_train(df_feature_matrix)

    return df_test, df_train


#################################
# prep data

# create id column and set as index
df_feature_matrix['index'] = ''

for column in col.list_id_vars:
    df_feature_matrix['index'] += df_feature_matrix[column].astype(str) + '//'

df_feature_matrix.set_index('index', inplace=True)

df_feature_matrix = df_feature_matrix[
    col.list_id_vars_not_cat + col.list_categorical_variables + col.list_numerical_variables
    + [col.customer_or_product_churn]]

df_feature_matrix.drop_duplicates(subset=col.list_id_vars, inplace=True)

# one hot encode variables that are not already 1/0 flags
for column in tqdm(col.list_categorical_variables_OHE):
    print(column)
    df_feature_matrix = df_feature_matrix.join(
        pd.get_dummies(df_feature_matrix[column], prefix=column))
    if column not in col.list_id_vars:
        df_feature_matrix.drop(columns=column, inplace=True)

for column in tqdm(col.dict_label_encode):
    df_feature_matrix[column] = df_feature_matrix[column].map(col.dict_label_encode[column])

# --- fill nans -------------------------------------------------------------------------------------------------- #
for column in tqdm(df_feature_matrix.columns):

    # check if column is an OHE column as will not want to drop and won't be in categoricals
    condition_ohe_column = False
    for ohe_column in col.list_categorical_variables_OHE:
        if ohe_column in column:
            condition_ohe_column = True

    if column in col.list_numerical_variables:
        median_val = df_feature_matrix[column].median()
        df_feature_matrix[column].fillna(value=median_val, inplace=True)

        # loop to drop columns where they're not correct in ETL
        if column not in col.list_id_vars:
            try:
                df_feature_matrix[column] = df_feature_matrix[column].astype(float)
            except ValueError:
                print(f'!! Warning, have dropped column {column} as could not convert to float'
                      f', unique values: {df_feature_matrix[column].unique()}')
                df_feature_matrix.drop(columns=column, inplace=True)

    elif column in col.list_categorical_variables or condition_ohe_column:
        try:
            mode_val = df_feature_matrix[column].mode()[0]
            df_feature_matrix[column].fillna(value=mode_val, inplace=True)
        except KeyError:
            print(f'!! Warning, error filling mode for {column}')

        # loop to drop columns where they're not correct in ETL
        if column not in col.list_id_vars:
            try:
                df_feature_matrix[column] = df_feature_matrix[column].astype(int)
            except ValueError:
                print(f'!! Warning, have dropped column {column} as could not convert to int'
                      f', unique values: {df_feature_matrix[column].unique()}')
                df_feature_matrix.drop(columns=column, inplace=True)

    elif column not in col.list_id_vars and column != col.customer_or_product_churn:
        print(f'!! Warning, have dropped column {column} as is not in categorical or numerical,'
              f' unique values {df_feature_matrix[column].unique()}')
        df_feature_matrix.drop(columns=column, inplace=True)

# --- outlier cleaning for training data ------------------------------------------------------------------------- #

# correct incorrect % change data
for column in df_feature_matrix.columns:
    if ('Discount' in column or 'discount' in column) and '%' in column:
        df_feature_matrix[column] = np.where(df_feature_matrix[column] &gt; 1, 1, df_feature_matrix[column])
    elif '%' in column and 'Usage' in column and ('Delta' in column or 'delta' in column):
        df_feature_matrix[column] = np.where(df_feature_matrix[column] &lt; -100, -100, df_feature_matrix[column])
    elif 'Upsell' in column:
        df_feature_matrix[column] = np.where(df_feature_matrix[column] &lt; 0, 0, df_feature_matrix[column])

# winsorize training set to remove effects of outliers in the modelling
for column in model_config.dict_winsorize_thresholds:
    threshold = model_config.dict_winsorize_thresholds[column]
    df_feature_matrix[column] = stats.mstats.winsorize(df_feature_matrix[column], limits=threshold)


#################################
# train on latest data
list_features = model_config.latest_feature_list

df_feature_matrix_train = df_feature_matrix[list_features + [col.parent_id, model_config.target_col]]

df_val, df_train = split_data_into_test_train_wrapper(df_feature_matrix_train)

X_train = df_train[list_features]
X_val = df_val[list_features]

y_train = df_train[model_config.target_col]
y_val = df_val[model_config.target_col]

model = CatBoostClassifier(**model_config.dict_hyperparams)

model.fit(X_train, y_train, eval_set=(X_val, y_val))

# --- accuracy metrics ----------------------------------------------------------------------------------------------- #

roc_auc_score_train = roc_auc_score(y_train, model.predict(X_train))
roc_auc_score_val = roc_auc_score(y_val, model.predict(X_val))

print(f'ROC-AUC scores:'
      f'\nTrain: {roc_auc_score_train}'
      f'\nVal: {roc_auc_score_val}')

df_train_cal = df_train.append(df_train[df_train[model_config.target_col] == 1])
X_train_cal = df_train_cal[list_features]
y_train_cal = df_train_cal[model_config.target_col]


#################################
# calibrate model for more representative probabilities

# need to check versions of sklearn as needs different inplementation
import sklearn
if sklearn.__version__ == '0.24.2':
    calibrator = IsotonicRegression(out_of_bounds='clip')
    calibrator.fit(model.predict_proba(X_train_cal)[:, 1], y_train_cal)

    calibrated_model = _CalibratedClassifier(model, [calibrator], method='isotonic', classes=model.classes_)

else:
    calibrated_model = CalibratedClassifierCV(model, method='isotonic', cv='prefit')
    calibrated_model.fit(X_train_cal, y_train_cal)


roc_auc_score_train_cal = roc_auc_score(y_train, calibrated_model.predict_proba(X_train)[:, 1])
roc_auc_score_val_cal = roc_auc_score(y_val, calibrated_model.predict_proba(X_val)[:, 1])

print(f'ROC-AUC scores calibrated:'
      f'\nTrain: {roc_auc_score_train_cal}'
      f'\nVal: {roc_auc_score_val_cal}')

feature_importance = pd.DataFrame(model.feature_importances_,
                                  index=X_train.columns,
                                  columns=['importance']).sort_values(by='importance', ascending=False)

print(feature_importance)



#################################
# export trained models

path_model = file_path['WorkflowPath_'][0] + 'models//model.pkl'
path_model_calibrated = file_path['WorkflowPath_'][0] + 'models//model_calibrated.pkl'

pickle.dump(model, open(path_model, 'wb'))
pickle.dump(calibrated_model, open(path_model_calibrated, 'wb'))</productionModeScript>
              <Port>61126</Port>
              <JupyterGuidDir>b7c6919cc6539312f69e6d79edc7426b</JupyterGuidDir>
              <JupyterGuidCopy />
              <LastExecutedByEngineVersion>2022.1.1.30961</LastExecutedByEngineVersion>
              <Notebook><![CDATA[{"cells":[{"cell_type":"markdown","metadata":{},"source":["Script to retrain model\n","\n","Note this retains the hyperparamteres and features in the existing model, but adds any further months of data\n","\n","Copied from retrain_model.py in alteryx_scripts in jman-WhitespaceChurnXSell"]},{"cell_type":"code","execution_count":1,"metadata":{"ayx":{"cell_class":"code_cell","cell_css":"border: 1px solid #58a; margin: 2px;","cell_type":"code","contents_keyword":"installPackages","first_line":"# List all non-standard packages to be imported by your","label":"deps"}},"outputs":[],"source":["# standard imports\n","\n","import pickle\n","import pandas as pd\n","import numpy as np\n","from math import exp\n","from tqdm import tqdm\n","\n","import scipy.stats as stats\n","\n","# alteryx imports\n","from ayx import Package\n","from ayx import Alteryx"]},{"cell_type":"code","execution_count":2,"metadata":{},"outputs":[],"source":["# non standard imports\n","\n","packages = ['catboost==0.24.2'] # non standard packages that might need installing\n","\n","from ayx import Package\n","# Package.installPackages(['catboost'], install_type='uninstall')\n","Package.installPackages(packages)\n","\n","print(\"Installation of required packages is complete.\")\n","\n"]},{"cell_type":"code","execution_count":3,"metadata":{},"outputs":[],"source":["from catboost import CatBoostClassifier\n","from sklearn.calibration import _CalibratedClassifier, CalibratedClassifierCV\n","from sklearn.isotonic import IsotonicRegression\n","from sklearn.metrics import roc_auc_score\n","from sklearn.model_selection import train_test_split"]},{"cell_type":"code","execution_count":4,"metadata":{},"outputs":[],"source":["# imports from the workflow\n","\n","df_feature_matrix = Alteryx.read('#1')\n","\n","file_path = Alteryx.read('#2')\n"]},{"cell_type":"code","execution_count":5,"metadata":{},"outputs":[],"source":["# define classes\n","\n","class ColumnHeaders:\n","\n","    def __init__(self, df_feature_matrix=None):\n","\n","        self.product_family = 'Product_Family'\n","        self.month = 'Month'\n","        self.parent_id = 'Parent customer ID'\n","        self.product_group = 'Product_Group'\n","        self.child_id = 'Child_ID'\n","        self.customer_or_product_churn = 'Customer_Or_Product_Churn'\n","        self.customer_churn = 'Customer_Churn'\n","        self.product_churn = 'Product_Churn'\n","        self.churn_probability = 'churn_probability'\n","        self.list_id_vars = [\n","                            self.product_family,\n","                             self.product_group,\n","                             self.parent_id,\n","                             self.child_id,\n","                             self.month]\n","\n","        self.list_id_vars_not_cat = [self.parent_id,\n","                                     self.child_id,\n","                                     self.month,\n","                                     self.product_group,\n","                                    self.product_family]\n","\n","        list_not_cat_var_dont_ohe = [self.parent_id,\n","                                     self.product_group,\n","                                     self.child_id,\n","                                     self.month,\n","                                     'Acquisition Date',\n","                                     'Month_Plus_1_Year',\n","                                     'Month_Plus_6_Months',\n","                                     'Month_Plus_3_Months',\n","                                     'Customer_Churn_Month',\n","                                     'Product_Join_Month',\n","                                     'First_Date_In_Snowball',\n","                                     'Month_Plus_2_Years',\n","                                     'Right_Month_Minus_1_Year',\n","                                     'Headquarters',\n","                                     'Region',\n","                                     'Specialties',\n","                                     'Industry',\n","                                     'indus',\n","                                    'Account Manager',\n","                                    'Company Size',\n","                                    'EBITDA LAY',\n","                                    'Employee Count',\n","                                    'Original Industry',\n","                                    'Parent customer ID',\n","                                    'Parent_BusinessName',\n","                                    'Revenue LAY',\n","                                    'Pivotal ID',\n","                                    'Parent_ID',\n","                                    'Sector']\n","\n","#         self.dict_label_encode = {'Company_size': {'0-1 employees': 1,\n","#                                                    '2-10 employees': 2,\n","#                                                    '11-50 employees': 3,\n","#                                                    '51-200 employees': 4,\n","#                                                    '201-500 employees': 5,\n","#                                                    '501-1,000 employees': 6,\n","#                                                    '1,001-5,000 employees': 7,\n","#                                                    '5,001-10,000 employees': 8,\n","#                                                    '10,001+ employees': 9},\n","        self.dict_label_encode = { 'NPS_Classification': {'Neutral': 1,\n","                                                         'Promoter': 2,\n","                                                         'Detractor': 0}}\n","\n","        self.list_churn_flags = [self.customer_churn,\n","                                 self.product_churn,\n","                                 self.customer_or_product_churn]\n","\n","        self.list_features_to_exclude = ['Years_Since_First_Date_In_Snowball',\n","                                         'Months_Since_First_Date_In_Snowball',\n","                                         'First_Date_In_Snowball_ARR',\n","                                         'Product_Lifetime']\n","\n","        if df_feature_matrix is not None:\n","            self.list_feature_and_target_columns = [column for column in df_feature_matrix.columns if\n","                                                    column not in self.list_id_vars_not_cat\n","                                                    and column not in self.list_features_to_exclude]\n","\n","        self.list_categorical_variables = []\n","        self.list_categorical_variables_OHE = []\n","        self.list_categorical_variables_label_encode = []\n","        self.list_numerical_variables = []\n","\n","        if df_feature_matrix is not None:\n","            for column in self.list_feature_and_target_columns:\n","\n","                # not a target variable of intentionally excluded\n","                if column not in self.list_churn_flags:\n","                    datatype = df_feature_matrix[column].dtype\n","                    count_distinct = len(df_feature_matrix[column].unique())\n","\n","                    if count_distinct == 2 or datatype in [str, object] and column not in list_not_cat_var_dont_ohe:\n","                        self.list_categorical_variables.append(column)\n","\n","                        if count_distinct > 2 and datatype in [str, object] and column not in self.dict_label_encode:\n","                            self.list_categorical_variables_OHE.append(column)\n","\n","                            if count_distinct > 5:\n","                                print(f'Warning, OHE for {column} may create too many columns,'\n","                                      f' {count_distinct} unique values')\n","\n","                        else:\n","                            self.list_categorical_variables_label_encode.append(column)\n","\n","                    elif datatype in [float, int] + [f'int{x}' for x in [16,32,64]] + [f'Int{x}' for x in [16,32,64]]:\n","                        self.list_numerical_variables.append(column)\n","\n","                    elif column not in list_not_cat_var_dont_ohe:\n","                        print(\n","                            f'!!! {column} not added to variable list, dtype: {datatype}, count distinct: {count_distinct}')\n","\n","\n","class ModelConfig:\n","    def __init__(self):\n","        col = ColumnHeaders()\n","\n","        # model settings\n","        self.target_col = col.customer_or_product_churn\n","        self.latest_feature_list = ['First_Date_In_Snowball_Delta_ARR_%',\n","                                    'Monthly_Delta_ARR_%',\n","                                    'L12M_Credit_Note_Count',\n","                                    'LTM_Flag_Downsell_organic',\n","                                    'LTM_Delta_Upsell_Organic',\n","                                    'L12M_Interactions_Change',\n","                                    'L12M_Delta_Usage_%',\n","                                    'Avg_Time_To_Agree_Renewal_in_Months',\n","                                    'Customer_Discount_%_of_ARR',\n","                                    'L3M_Ticket_Resolution_Time_Green',\n","                                    'L3M_Increase_in_Ticket_Count',\n","                                    'L12M Escalation Flag',\n","                                    'L12M_Avg_NPS_Score']\n","\n","        self.dict_winsorize_thresholds = {'L3M_Ticket_Resolution_Time_Green': 0.10,\n","                                          'L12M_Delta_Usage_%': 0.005,\n","                                          'LTM_Delta_Upsell_Organic': 0.005,\n","                                          'First_Date_In_Snowball_Delta_ARR_%': 0.05,\n","                                          'L12M_Interactions_Change': 0.05,\n","                                          'Monthly_Delta_ARR_%': 0.005,\n","                                          'Avg_Time_To_Agree_Renewal_in_Months': 0.01,\n","                                          'Customer_Discount_%_of_ARR': 0.005}\n","\n","        # hyper-params\n","        self.class_weights = {0: 1,\n","                              1: 12}  # weight incorrect classification of churn 12x higher\n","        \n","        self.dict_hyperparams = {'iterations': 500,\n","                                 'verbose': False,\n","                                 'eval_metric': 'AUC',\n","                                 'class_weights': self.class_weights,\n","                                 # logloss for 2-class classification\n","                                 'loss_function': 'Logloss',\n","                                 # built in facility to prevent overfitting\n","                                 'use_best_model': True,\n","                                 # limit the number of splits by feature\n","                                 'border_count': 40}\n","\n","        # modelling adjustments\n","        self.test_split = 0.2\n","        self.rand_state = 0\n","\n"]},{"cell_type":"code","execution_count":6,"metadata":{},"outputs":[],"source":["# define constants\n","\n","model_config = ModelConfig()\n","\n","\n","# filter to include as many months as possible where we know churn has happened (3-12 months out)\n","last_month_for_training = str((pd.to_datetime(df_feature_matrix['Month'].max()) - pd.DateOffset(months=12)).date())\n","first_month_for_training = '2019-09-01'  # fixed for now due to keeping at similar churn levels\n","condition_training_data = (df_feature_matrix['Month'] <= last_month_for_training) & (\n","        df_feature_matrix['Month'] >= first_month_for_training)\n","df_feature_matrix = df_feature_matrix[condition_training_data]\n","\n","col = ColumnHeaders(df_feature_matrix)\n","\n","list_features = model_config.latest_feature_list"]},{"cell_type":"code","execution_count":7,"metadata":{},"outputs":[],"source":["# define test-train split function\n","\n","def split_data_into_test_train_wrapper(df_feature_matrix,\n","                                       unique_variable=col.parent_id,\n","                                       test_split=model_config.test_split,\n","                                       rand_state=model_config.rand_state,\n","                                       split_target_evenly=True):\n","    def split_data_set_into_test_train(df_feature_matrix=df_feature_matrix,\n","                                       unique_variable=unique_variable,\n","                                       test_split=test_split,\n","                                       rand_state=rand_state):\n","        \"\"\"\n","        Split the dataset into a test-train set based on a specific unique variable.\n","        This is needed to avoid falsely inflating the accuracy if e.g. there are several observations for the same customer\n","        :param df_feature_matrix:\n","        :param target_variable:\n","        :param unique_variable:\n","        :param test_split:\n","        :return:\n","        \"\"\"\n","        df_unique = df_feature_matrix.drop_duplicates(subset=unique_variable)\n","\n","        df_train_unique, df_test_unique = train_test_split(df_unique, test_size=test_split, random_state=rand_state)\n","\n","        list_train_unique = df_train_unique[unique_variable].to_list()\n","        list_test_unique = df_test_unique[unique_variable].to_list()\n","\n","        df_features_train = df_feature_matrix[\n","            df_feature_matrix[unique_variable].isin(list_train_unique)]\n","        df_features_test = df_feature_matrix[df_feature_matrix[unique_variable].isin(list_test_unique)]\n","\n","        return df_features_train, df_features_test\n","\n","    if split_target_evenly:\n","        # need to keep churn split fairly similar across test and train to avoid skew\n","        # make sure a customer is still only in one set\n","        list_churned_customers = [*df_feature_matrix[df_feature_matrix[model_config.target_col] == 1][\n","            unique_variable].unique()]\n","\n","        df_feature_matrix_churn = df_feature_matrix[df_feature_matrix[unique_variable].isin(list_churned_customers)]\n","        df_feature_matrix_not_churn = df_feature_matrix[\n","            ~df_feature_matrix[unique_variable].isin(list_churned_customers)]\n","\n","        df_train_churn, df_test_churn = split_data_set_into_test_train(df_feature_matrix_churn)\n","        df_train_not_churn, df_test_not_churn = split_data_set_into_test_train(df_feature_matrix_not_churn)\n","\n","        df_train = df_train_churn.append(df_train_not_churn)\n","        df_test = df_test_churn.append(df_test_not_churn)\n","    else:\n","        df_train, df_test = split_data_set_into_test_train(df_feature_matrix)\n","\n","    return df_test, df_train"]},{"cell_type":"code","execution_count":8,"metadata":{"scrolled":true},"outputs":[],"source":["# prep data\n","\n","# create id column and set as index\n","df_feature_matrix['index'] = ''\n","\n","for column in col.list_id_vars:\n","    df_feature_matrix['index'] += df_feature_matrix[column].astype(str) + '//'\n","\n","df_feature_matrix.set_index('index', inplace=True)\n","\n","df_feature_matrix = df_feature_matrix[\n","    col.list_id_vars_not_cat + col.list_categorical_variables + col.list_numerical_variables\n","    + [col.customer_or_product_churn]]\n","\n","df_feature_matrix.drop_duplicates(subset=col.list_id_vars, inplace=True)\n","\n","# one hot encode variables that are not already 1/0 flags\n","for column in tqdm(col.list_categorical_variables_OHE):\n","    print(f'OHE then dropping column: {column}')\n","    df_feature_matrix = df_feature_matrix.join(\n","        pd.get_dummies(df_feature_matrix[column], prefix=column))\n","    if column not in col.list_id_vars:\n","        df_feature_matrix.drop(columns=column, inplace=True)\n","\n","for column in tqdm(col.dict_label_encode):\n","    df_feature_matrix[column] = df_feature_matrix[column].map(col.dict_label_encode[column])\n","\n","# --- fill nans -------------------------------------------------------------------------------------------------- #\n","for column in tqdm(df_feature_matrix.columns):\n","\n","    # check if column is an OHE column as will not want to drop and won't be in categoricals\n","    condition_ohe_column = False\n","    for ohe_column in col.list_categorical_variables_OHE:\n","        if ohe_column in column:\n","            condition_ohe_column = True\n","\n","    if column in col.list_numerical_variables:\n","        median_val = df_feature_matrix[column].median()\n","        df_feature_matrix[column].fillna(value=median_val, inplace=True)\n","\n","        # loop to drop columns where they're not correct in ETL\n","        if column not in col.list_id_vars:\n","            try:\n","                df_feature_matrix[column] = df_feature_matrix[column].astype(float)\n","            except ValueError:\n","                print(f'!! Warning, have dropped column {column} as could not convert to float'\n","                      f', unique values: {df_feature_matrix[column].unique()}')\n","                df_feature_matrix.drop(columns=column, inplace=True)\n","\n","    elif column in col.list_categorical_variables or condition_ohe_column:\n","        try:\n","            mode_val = df_feature_matrix[column].mode()[0]\n","            df_feature_matrix[column].fillna(value=mode_val, inplace=True)\n","        except KeyError:\n","            print(f'!! Warning, error filling mode for {column}')\n","\n","        # loop to drop columns where they're not correct in ETL\n","        if column not in col.list_id_vars:\n","            try:\n","                df_feature_matrix[column] = df_feature_matrix[column].astype(int)\n","            except ValueError:\n","                print(f'!! Warning, have dropped column {column} as could not convert to int'\n","                      f', unique values: {df_feature_matrix[column].unique()}')\n","                df_feature_matrix.drop(columns=column, inplace=True)\n","            except TypeError:\n","                print(f'!! Warning, have dropped column {column} as could not convert to int'\n","                      f', unique values: {df_feature_matrix[column].unique()}')\n","                df_feature_matrix.drop(columns=column, inplace=True)\n","\n","    elif column not in col.list_id_vars and column != col.customer_or_product_churn:\n","        print(f'!! Warning, have dropped column {column} as is not in categorical or numerical,'\n","              f' unique values {df_feature_matrix[column].unique()}')\n","        df_feature_matrix.drop(columns=column, inplace=True)\n","\n","# --- outlier cleaning for training data ------------------------------------------------------------------------- #\n","\n","# correct incorrect % change data\n","for column in df_feature_matrix.columns:\n","    if ('Discount' in column or 'discount' in column) and '%' in column:\n","        df_feature_matrix[column] = np.where(df_feature_matrix[column] > 1, 1, df_feature_matrix[column])\n","    elif '%' in column and 'Usage' in column and ('Delta' in column or 'delta' in column):\n","        df_feature_matrix[column] = np.where(df_feature_matrix[column] < -100, -100, df_feature_matrix[column])\n","    elif 'Upsell' in column:\n","        df_feature_matrix[column] = np.where(df_feature_matrix[column] < 0, 0, df_feature_matrix[column])\n","\n","# winsorize training set to remove effects of outliers in the modelling\n","for column in model_config.dict_winsorize_thresholds:\n","    threshold = model_config.dict_winsorize_thresholds[column]\n","    df_feature_matrix[column] = stats.mstats.winsorize(df_feature_matrix[column], limits=threshold)"]},{"cell_type":"code","execution_count":9,"metadata":{},"outputs":[],"source":["# needed as alteryx converts to e.g. int64 which catboost doesn't like\n","for column in df_feature_matrix.columns:\n","    if column not in col.list_id_vars:\n","        mod = df_feature_matrix[column] % 1\n","        if mod.sum() > 0:\n","            df_feature_matrix[column] = df_feature_matrix[column].astype(float)\n","        else:\n","            df_feature_matrix[column] = df_feature_matrix[column].astype(int)"]},{"cell_type":"code","execution_count":10,"metadata":{"scrolled":false},"outputs":[],"source":["\n","\n","# train on latest data\n","list_features = model_config.latest_feature_list\n","\n","df_feature_matrix_train = df_feature_matrix[list_features + [col.parent_id, model_config.target_col]]\n","\n","df_val, df_train = split_data_into_test_train_wrapper(df_feature_matrix_train)\n","\n","X_train = df_train[list_features]\n","X_val = df_val[list_features]\n","\n","y_train = df_train[model_config.target_col]\n","y_val = df_val[model_config.target_col]\n","\n","model = CatBoostClassifier(**model_config.dict_hyperparams)\n","\n","model.fit(X_train, y_train, eval_set=(X_val, y_val))\n","\n","# --- accuracy metrics ----------------------------------------------------------------------------------------------- #\n","\n","roc_auc_score_train = roc_auc_score(y_train, model.predict(X_train))\n","roc_auc_score_val = roc_auc_score(y_val, model.predict(X_val))\n","\n","print(f'ROC-AUC scores:'\n","      f'\\nTrain: {roc_auc_score_train}'\n","      f'\\nVal: {roc_auc_score_val}')\n","\n","df_train_cal = df_train.append(df_train[df_train[model_config.target_col] == 1])\n","X_train_cal = df_train_cal[list_features]\n","y_train_cal = df_train_cal[model_config.target_col]"]},{"cell_type":"code","execution_count":11,"metadata":{},"outputs":[],"source":["# calibrate model for more representative probabilities\n","\n","# need to check versions of sklearn as needs different inplementation\n","import sklearn\n","if sklearn.__version__ == '0.24.2':\n","    calibrator = IsotonicRegression(out_of_bounds='clip')\n","    calibrator.fit(model.predict_proba(X_train_cal)[:, 1], y_train_cal)\n","\n","    calibrated_model = _CalibratedClassifier(model, [calibrator], method='isotonic', classes=model.classes_)\n","\n","else:\n","    calibrated_model = CalibratedClassifierCV(model, method='isotonic', cv='prefit')\n","    calibrated_model.fit(X_train_cal, y_train_cal)\n","\n","\n","roc_auc_score_train_cal = roc_auc_score(y_train, calibrated_model.predict_proba(X_train)[:, 1])\n","roc_auc_score_val_cal = roc_auc_score(y_val, calibrated_model.predict_proba(X_val)[:, 1])\n","\n","print(f'ROC-AUC scores calibrated:'\n","      f'\\nTrain: {roc_auc_score_train_cal}'\n","      f'\\nVal: {roc_auc_score_val_cal}')\n","\n","feature_importance = pd.DataFrame(model.feature_importances_,\n","                                  index=X_train.columns,\n","                                  columns=['importance']).sort_values(by='importance', ascending=False)\n","\n","print(feature_importance)\n"]},{"cell_type":"code","execution_count":12,"metadata":{},"outputs":[],"source":["# export trained models\n","\n","path_model = file_path['WorkflowPath_'][0] + 'models//model_hcm20230330.pkl'\n","path_model_calibrated = file_path['WorkflowPath_'][0] + 'models//model_calibrated_hcm20230330.pkl'\n","\n","pickle.dump(model, open(path_model, 'wb'))\n","pickle.dump(calibrated_model, open(path_model_calibrated, 'wb'))"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]}],"metadata":{"kernelspec":{"display_name":"designerbasetools_venv","language":"python","name":"designerbasetools_venv"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.5"}},"nbformat":4,"nbformat_minor":2}]]></Notebook>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxJupyterPluginEngine.dll" EngineDllEntryPoint="AlteryxJupyter" />
        </Node>
        <Node ToolID="11">
          <GuiSettings Plugin="AlteryxBasePluginsGui.AlteryxSelect.AlteryxSelect">
            <Position x="2383" y="165" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <OrderChanged value="True" />
              <CommaDecimal value="False" />
              <SelectFields>
                <SelectField field="Accountancy" selected="True" />
                <SelectField field="Acquisition_Date" selected="True" />
                <SelectField field="Acquisition_Flag" selected="True" />
                <SelectField field="ARR last month" selected="True" />
                <SelectField field="ARR_LY" selected="True" />
                <SelectField field="ARR_vs_LY" selected="True" />
                <SelectField field="Avg_Contract Days Left" selected="True" />
                <SelectField field="Avg_Price Increase %" selected="True" />
                <SelectField field="Avg_Time_To_Agree_Renewal_in_Months" selected="True" />
                <SelectField field="Child_Business_Name" selected="True" />
                <SelectField field="Customer_Cohort" selected="True" />
                <SelectField field="Employee Number" selected="False" />
                <SelectField field="Employee_Band" selected="True" />
                <SelectField field="Employee_Size" selected="True" />
                <SelectField field="ExtractionTime" selected="True" />
                <SelectField field="Is_Cloud_Product" selected="True" />
                <SelectField field="Is_Recurring" selected="True" />
                <SelectField field="Is_SaaS_Product" selected="True" />
                <SelectField field="Is_Upsell_Product" selected="True" />
                <SelectField field="L12M churn" selected="True" />
                <SelectField field="L12M credit notes" selected="True" />
                <SelectField field="L12M cross sell M&amp;A" selected="True" />
                <SelectField field="L12M cross sell organic" selected="True" />
                <SelectField field="L12M downgrade" selected="True" />
                <SelectField field="L12M downsell M&amp;A" selected="True" />
                <SelectField field="L12M downsell organic" selected="True" />
                <SelectField field="L12M upsell M&amp;A" selected="True" />
                <SelectField field="L12M upsell organic" selected="True" />
                <SelectField field="L12M_Delta_Limit" selected="True" />
                <SelectField field="L12M_Delta_Usage" selected="True" />
                <SelectField field="L12M_Delta_Usage_%" selected="True" />
                <SelectField field="L3M increase in tickets" selected="True" />
                <SelectField field="L3M_Delta_Limit" selected="True" />
                <SelectField field="L3M_Delta_Usage" selected="True" />
                <SelectField field="L3M_Delta_Usage_%" selected="True" />
                <SelectField field="L6M increase in tickets2" selected="True" />
                <SelectField field="L6M_Delta_Limit" selected="True" />
                <SelectField field="L6M_Delta_Usage" selected="True" />
                <SelectField field="L6M_Delta_Usage_%" selected="True" />
                <SelectField field="Legal_Entity" selected="True" />
                <SelectField field="Limit" selected="True" />
                <SelectField field="LM_Delta_Limit" selected="True" />
                <SelectField field="LM_Delta_Usage" selected="True" />
                <SelectField field="LM_Delta_Usage_%" selected="True" />
                <SelectField field="LTM_Delta_Add_M&amp;A" selected="True" />
                <SelectField field="LTM_Delta_Add_Organic" selected="True" />
                <SelectField field="LTM_Delta_Price_Change" selected="True" />
                <SelectField field="LTM_Delta_Volume_Change" selected="True" />
                <SelectField field="LTM_Flag_Add" selected="True" />
                <SelectField field="LTM_Flag_Add_M&amp;A" selected="True" />
                <SelectField field="LTM_Flag_Add_Organic" selected="True" />
                <SelectField field="LTM_Flag_Downsell_Organic" selected="False" />
                <SelectField field="Marketing Sector" selected="True" />
                <SelectField field="Monthly_ARR_Down" selected="True" />
                <SelectField field="Monthly_ARR_Up" selected="True" />
                <SelectField field="Monthly_Check_Delta" selected="True" />
                <SelectField field="Monthly_Delta_Add_M&amp;A" selected="True" />
                <SelectField field="Monthly_Delta_Add_Organic" selected="True" />
                <SelectField field="Monthly_Delta_Price_Change" selected="True" />
                <SelectField field="Monthly_Delta_Volume_Change" selected="True" />
                <SelectField field="Monthly_Flag_Add_M&amp;A" selected="True" />
                <SelectField field="Monthly_Flag_Add_Organic" selected="True" />
                <SelectField field="Non_Recurring_Revenue" selected="True" />
                <SelectField field="Parent_Business_Name" selected="True" />
                <SelectField field="Parent_ID" selected="True" />
                <SelectField field="Parent_Sector" selected="True" />
                <SelectField field="Pivotal ID" selected="True" />
                <SelectField field="Pre_Acquisition_Revenue_Flag" selected="True" />
                <SelectField field="Product_Acquired_Flag" selected="True" />
                <SelectField field="Product_Churn_Month" selected="True" />
                <SelectField field="Product_Division" selected="True" />
                <SelectField field="Product_Division_Group" selected="True" />
                <SelectField field="Product_Functionality" selected="True" />
                <SelectField field="Product_Functionality_Group" selected="True" />
                <SelectField field="Product_Last_Month" selected="True" />
                <SelectField field="R_ARR" selected="True" />
                <SelectField field="R_Month" selected="True" />
                <SelectField field="R_Parent_ID" selected="True" />
                <SelectField field="Resolution Status_Name" selected="True" />
                <SelectField field="Right_Accountancy" selected="True" />
                <SelectField field="Right_Other Professional Services" selected="True" />
                <SelectField field="Right_Parent_ID" selected="False" />
                <SelectField field="Sectors From Enriched Data" selected="True" />
                <SelectField field="Source" selected="True" />
                <SelectField field="System" selected="True" />
                <SelectField field="Usage" selected="True" />
                <SelectField field="Usage %" selected="True" />
                <SelectField field="Use_Reoccur_Logic" selected="True" />
                <SelectField field="WatermarkValue" selected="True" />
                <SelectField field="Yearly_ARR_Down" selected="True" />
                <SelectField field="Yearly_ARR_Up" selected="True" />
                <SelectField field="Yearly_Check_Delta" selected="True" />
                <SelectField field="Account Manager" selected="True" />
                <SelectField field="ARR" selected="True" />
                <SelectField field="ARR_12mo_ago" selected="True" />
                <SelectField field="ARR_LM" selected="True" />
                <SelectField field="ARR_vs_12mo_ago" selected="True" />
                <SelectField field="ARR_vs_LM" selected="True" />
                <SelectField field="Child_ID" selected="True" />
                <SelectField field="Company Size" selected="True" />
                <SelectField field="Customer Cohort Year" selected="True" />
                <SelectField field="Customer_Churn" selected="True" />
                <SelectField field="Customer_Churn_Month" selected="False" />
                <SelectField field="Customer_Discount_%_of_ARR" selected="True" />
                <SelectField field="Customer_Or_Product_Churn" selected="True" />
                <SelectField field="EBITDA LAY" selected="False" />
                <SelectField field="Employee Count" selected="True" />
                <SelectField field="First_Date_In_Snowball" selected="True" />
                <SelectField field="First_Date_In_Snowball_Annual_Delta_ARR" selected="True" />
                <SelectField field="First_Date_In_Snowball_ARR" selected="True" />
                <SelectField field="First_Date_In_Snowball_CAGR_ARR" selected="True" />
                <SelectField field="First_Date_In_Snowball_Delta_ARR" selected="True" />
                <SelectField field="First_Date_In_Snowball_Delta_ARR_%" selected="True" />
                <SelectField field="Flag_L12M_Decrease_in_NPS_Score" selected="True" />
                <SelectField field="Flag_L24M_Decrease_in_NPS_Score" selected="True" />
                <SelectField field="Industry" selected="True" />
                <SelectField field="Interactions (in-month)" selected="True" />
                <SelectField field="L12M account managers" selected="True" />
                <SelectField field="L12M AM interactions" selected="True" />
                <SelectField field="L12M escalated tickets" selected="True" />
                <SelectField field="L12M Escalation Flag" selected="True" type="Int16" size="2" />
                <SelectField field="L12M incorrect billing credit notes" selected="True" />
                <SelectField field="L12M increase in amber tickets" selected="True" />
                <SelectField field="L12M increase in red tickets" selected="True" />
                <SelectField field="L12M increase in tickets" selected="True" />
                <SelectField field="L12M increase in tickets2" selected="True" />
                <SelectField field="L12M licenses" selected="True" />
                <SelectField field="L12M licenses delta" selected="True" />
                <SelectField field="L12M SLA closure violations" selected="True" />
                <SelectField field="L12M SLA response violations" selected="True" />
                <SelectField field="L12M SLA violations" selected="True" />
                <SelectField field="L12M ticket count" selected="True" />
                <SelectField field="L12M tickets (amber)" selected="True" />
                <SelectField field="L12M tickets (green)" selected="True" />
                <SelectField field="L12M tickets (red)" selected="True" />
                <SelectField field="L12M tickets closed in 24 hours" selected="True" />
                <SelectField field="L12M tickets closed in 48 hours" selected="True" />
                <SelectField field="L12M tickets reopened" selected="True" />
                <SelectField field="L12M total days tickets open" selected="True" />
                <SelectField field="L12M total discount" selected="True" />
                <SelectField field="L12M_Avg_NPS_Score" selected="True" />
                <SelectField field="L12M_Change_in_NPS_Score" selected="True" />
                <SelectField field="L12M_Credit_Note_Count" selected="True" />
                <SelectField field="L12M_Interactions_Change" selected="True" />
                <SelectField field="L24M_Change_in_NPS_Score" selected="True" />
                <SelectField field="L2M credit notes" selected="True" />
                <SelectField field="L2M incorrect billing credit notes" selected="True" />
                <SelectField field="L3M escalated tickets" selected="True" />
                <SelectField field="L3M increase in amber tickets" selected="True" />
                <SelectField field="L3M increase in red tickets" selected="True" />
                <SelectField field="L3M inrease in tickets" selected="True" />
                <SelectField field="L3M SLA closure violations" selected="True" />
                <SelectField field="L3M SLA response violations" selected="True" />
                <SelectField field="L3M SLA violations" selected="True" />
                <SelectField field="L3M ticket count" selected="True" />
                <SelectField field="L3M tickets (amber)" selected="True" />
                <SelectField field="L3M tickets (green)" selected="True" rename="L3M_Ticket_Resolution_Time_Green" />
                <SelectField field="L3M tickets (red)" selected="True" />
                <SelectField field="L3M tickets closed in 24 hours" selected="True" />
                <SelectField field="L3M tickets closed in 48 hours" selected="True" />
                <SelectField field="L3M tickets reopened" selected="True" />
                <SelectField field="L3M total days ticket open" selected="True" />
                <SelectField field="L3M_Increase_in_Ticket_Count" selected="True" />
                <SelectField field="L6M account managers" selected="True" />
                <SelectField field="L6M AM interactions" selected="True" />
                <SelectField field="L6M credit notes" selected="True" />
                <SelectField field="L6M escalated tickets" selected="True" />
                <SelectField field="L6M incorrect billing credit notes" selected="True" />
                <SelectField field="L6M increase in amber tickets" selected="True" />
                <SelectField field="L6M increase in red tickets" selected="True" />
                <SelectField field="L6M increase in tickets" selected="True" />
                <SelectField field="L6M licenses" selected="True" />
                <SelectField field="L6M licenses delta" selected="True" />
                <SelectField field="L6M SLA closure violations" selected="True" />
                <SelectField field="L6M SLA response violations" selected="True" />
                <SelectField field="L6M SLA violations" selected="True" />
                <SelectField field="L6M ticket count" selected="True" />
                <SelectField field="L6M tickets (amber)" selected="True" />
                <SelectField field="L6M tickets (green)" selected="True" />
                <SelectField field="L6M tickets (red)" selected="True" />
                <SelectField field="L6M tickets closed in 24 hours" selected="True" />
                <SelectField field="L6M tickets closed in 48 hours" selected="True" />
                <SelectField field="L6M tickets reopened" selected="True" />
                <SelectField field="L6M total days tickets open" selected="True" />
                <SelectField field="Licenses" selected="True" />
                <SelectField field="LTM_ARR_Decrease" selected="True" />
                <SelectField field="LTM_Delta_AddAcq" selected="True" />
                <SelectField field="LTM_Delta_AddOrg" selected="True" />
                <SelectField field="LTM_Delta_ARR_%" selected="True" />
                <SelectField field="LTM_Delta_Churn" selected="True" />
                <SelectField field="LTM_Delta_Cross_Sell_M&amp;A" selected="True" />
                <SelectField field="LTM_Delta_Cross_Sell_Organic" selected="True" />
                <SelectField field="LTM_Delta_Downgrade" selected="True" />
                <SelectField field="LTM_Delta_Downsell_M&amp;A" selected="True" />
                <SelectField field="LTM_Delta_Downsell_Organic" selected="True" />
                <SelectField field="LTM_Delta_Reoccurring" selected="True" />
                <SelectField field="LTM_Delta_Upsell_M&amp;A" selected="True" />
                <SelectField field="LTM_Delta_Upsell_Organic" selected="True" />
                <SelectField field="LTM_Downsell_Organic_%_ARR" selected="True" type="Double" size="8" />
                <SelectField field="LTM_Flag_AddAcq" selected="True" />
                <SelectField field="LTM_Flag_AddOrg" selected="True" />
                <SelectField field="LTM_Flag_Churn" selected="True" />
                <SelectField field="LTM_Flag_Cross_Sell" selected="True" />
                <SelectField field="LTM_Flag_Cross_Sell_M&amp;A" selected="True" />
                <SelectField field="LTM_Flag_Cross_Sell_Organic" selected="True" />
                <SelectField field="LTM_Flag_Downgrade" selected="True" />
                <SelectField field="LTM_Flag_Downsell" selected="True" rename="LTM_Flag_Downsell_organic" />
                <SelectField field="LTM_Flag_Downsell_M&amp;A" selected="True" />
                <SelectField field="LTM_Flag_Existing_Customer" selected="True" />
                <SelectField field="LTM_Flag_Existing_Product" selected="True" />
                <SelectField field="LTM_Flag_Reoccurring" selected="True" />
                <SelectField field="LTM_Flag_Upsell" selected="True" />
                <SelectField field="LTM_Flag_Upsell_M&amp;A" selected="True" />
                <SelectField field="LTM_Flag_Upsell_Organic" selected="True" />
                <SelectField field="LTM_Upsell_Downsell_M&amp;A_%_ARR" selected="True" />
                <SelectField field="LTM_Upsell_Downsell_Organic_%_ARR" selected="True" />
                <SelectField field="LTM_Upsell_Organic_%_ARR" selected="True" type="Float" size="4" />
                <SelectField field="M-12_L12M_Avg_NPS_Score" selected="True" />
                <SelectField field="M-24_L12M_Avg_NPS_Score" selected="True" />
                <SelectField field="Month" selected="True" />
                <SelectField field="Monthly_ARR_Decrease" selected="True" />
                <SelectField field="Monthly_Delta_AddAcq" selected="True" />
                <SelectField field="Monthly_Delta_AddOrg" selected="True" />
                <SelectField field="Monthly_Delta_ARR_%" selected="True" />
                <SelectField field="Monthly_Delta_Churn" selected="True" />
                <SelectField field="Monthly_Delta_Cross_Sell_M&amp;A" selected="True" />
                <SelectField field="Monthly_Delta_Cross_Sell_Organic" selected="True" />
                <SelectField field="Monthly_Delta_Downgrade" selected="True" />
                <SelectField field="Monthly_Delta_Downsell_M&amp;A" selected="True" />
                <SelectField field="Monthly_Delta_Downsell_Organic" selected="True" />
                <SelectField field="Monthly_Delta_Reoccurring" selected="True" />
                <SelectField field="Monthly_Delta_Upsell_M&amp;A" selected="True" />
                <SelectField field="Monthly_Delta_Upsell_Organic" selected="True" />
                <SelectField field="Monthly_Flag_Add" selected="True" />
                <SelectField field="Monthly_Flag_AddAcq" selected="True" />
                <SelectField field="Monthly_Flag_AddOrg" selected="True" />
                <SelectField field="Monthly_Flag_Churn" selected="True" />
                <SelectField field="Monthly_Flag_Cross_Sell" selected="True" />
                <SelectField field="Monthly_Flag_Cross_Sell_M&amp;A" selected="True" />
                <SelectField field="Monthly_Flag_Cross_Sell_Organic" selected="True" />
                <SelectField field="Monthly_Flag_Downgrade" selected="True" />
                <SelectField field="Monthly_Flag_Downsell" selected="True" />
                <SelectField field="Monthly_Flag_Downsell_M&amp;A" selected="True" />
                <SelectField field="Monthly_Flag_Downsell_Organic" selected="True" />
                <SelectField field="Monthly_Flag_Existing_Customer" selected="True" />
                <SelectField field="Monthly_Flag_Existing_Product" selected="True" />
                <SelectField field="Monthly_Flag_Reoccurring" selected="True" />
                <SelectField field="Monthly_Flag_Upsell" selected="True" />
                <SelectField field="Monthly_Flag_Upsell_M&amp;A" selected="True" />
                <SelectField field="Monthly_Flag_Upsell_Organic" selected="True" />
                <SelectField field="Months_Since_First_Date_In_Snowball" selected="True" type="Double" size="8" />
                <SelectField field="No_of_Product_Groups" selected="True" />
                <SelectField field="NPS_Classification" selected="True" />
                <SelectField field="Original Industry" selected="False" />
                <SelectField field="Other Professional Services" selected="False" />
                <SelectField field="Parent customer ID" selected="True" />
                <SelectField field="Parent_BusinessName" selected="False" />
                <SelectField field="Parent_Customer_ID" selected="False" />
                <SelectField field="Parent_Division" selected="False" />
                <SelectField field="Parent_No_of_Product_Groups" selected="True" />
                <SelectField field="Parent_No_Product_Families" selected="True" />
                <SelectField field="Previous L12M interactions" selected="True" />
                <SelectField field="Previous L6M interactions" selected="True" />
                <SelectField field="Product_Churn" selected="True" />
                <SelectField field="Product_Family" selected="True" />
                <SelectField field="Product_Group" selected="True" />
                <SelectField field="Product_IsCloud" selected="False" />
                <SelectField field="Product_IsSaaS" selected="False" />
                <SelectField field="Product_IsUpsell" selected="False" />
                <SelectField field="Product_Join_Month" selected="False" />
                <SelectField field="Product_Lifetime" selected="False" />
                <SelectField field="Responded_to_NPS_Survey" selected="True" />
                <SelectField field="Revenue LAY" selected="False" />
                <SelectField field="Right_Customer Cohort Year" selected="False" />
                <SelectField field="Sector" selected="False" />
                <SelectField field="Tenure_yrs" selected="False" />
                <SelectField field="Ticket count (in-month)" selected="True" />
                <SelectField field="Time stamp" selected="False" />
                <SelectField field="Total ARR" selected="True" />
                <SelectField field="Total_Monthly_Customer_ARR" selected="True" />
                <SelectField field="Years_Since_First_Date_In_Snowball" selected="True" />
                <SelectField field="LTM_Flag_Downsell_organic" selected="True" />
                <SelectField field="Left_Left_Accountancy" selected="True" />
                <SelectField field="Left_Left_Other Professional Services" selected="True" />
                <SelectField field="Left_Accountancy2" selected="True" />
                <SelectField field="Left_Other Professional Services2" selected="True" />
                <SelectField field="Left_Accountancy" selected="True" />
                <SelectField field="Left_Other Professional Services" selected="True" />
                <SelectField field="*Unknown" selected="True" />
              </SelectFields>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxSelect" />
        </Node>
      </ChildNodes>
    </Node>
    <Node ToolID="25">
      <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
        <Position x="69" y="944" width="414" height="225" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Caption>Import customer 360</Caption>
          <Style TextColor="#314c4a" FillColor="#ecf2f2" BorderColor="#314c4a" Transparency="25" Margin="25" />
          <Disabled value="False" />
          <Folded value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <ChildNodes>
        <Node ToolID="10">
          <GuiSettings Plugin="LockInGui.LockInInput.LockInInput">
            <Position x="94" y="996" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Connection>File:C:\Users\Public\Churn Prediction\1. Alteryx Workflows\In-DB connection.indbc</Connection>
              <Query>select [06_Customer360TimeSeries].* 
from [06_Customer360TimeSeries]
Where [Parent_Division] = 'HCM'</Query>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <AnnotationText>Import customer 360</AnnotationText>
              <DefaultAnnotationText>Source=File:C:\Users\Public\Churn Prediction\1. Alteryx Workflows\In-DB connection.indbc
Query=select [06_Customer360TimeSe...</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInInput" />
        </Node>
        <Node ToolID="16">
          <GuiSettings Plugin="LockInGui.LockInSelect.LockInSelect">
            <Position x="190" y="996" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <OrderChanged value="True" />
              <CommaDecimal value="False" />
              <SelectFields>
                <SelectField field="Company Size" selected="True" />
                <SelectField field="EBITDA LAY" selected="True" />
                <SelectField field="Employee Count" selected="True" />
                <SelectField field="Industry" selected="True" />
                <SelectField field="Original Industry" selected="True" />
                <SelectField field="Revenue LAY" selected="True" />
                <SelectField field="Right_Accountancy" selected="True" />
                <SelectField field="Right_Other Professional Services" selected="True" />
                <SelectField field="Account Manager" selected="True" />
                <SelectField field="Accountancy" selected="True" />
                <SelectField field="ARR" selected="True" rename="Total ARR" />
                <SelectField field="ARR last month" selected="False" />
                <SelectField field="ARR_12mo_ago" selected="False" />
                <SelectField field="Avg_Contract Days Left" selected="True" />
                <SelectField field="Avg_Price Increase %" selected="True" />
                <SelectField field="Avg_Time_To_Agree_Renewal_in_Months" selected="True" />
                <SelectField field="Customer Cohort Year" selected="True" />
                <SelectField field="Customer_Discount_%_of_ARR" selected="True" />
                <SelectField field="Flag_L12M_Decrease_in_NPS_Score" selected="True" />
                <SelectField field="Flag_L24M_Decrease_in_NPS_Score" selected="True" />
                <SelectField field="Interactions (in-month)" selected="True" />
                <SelectField field="L12M account managers" selected="True" />
                <SelectField field="L12M AM interactions" selected="True" />
                <SelectField field="L12M churn" selected="False" />
                <SelectField field="L12M credit notes" selected="True" rename="L12M_Credit_Note_Count" />
                <SelectField field="L12M cross sell M&amp;A" selected="False" />
                <SelectField field="L12M cross sell organic" selected="False" />
                <SelectField field="L12M downgrade" selected="False" />
                <SelectField field="L12M downsell M&amp;A" selected="False" />
                <SelectField field="L12M downsell organic" selected="False" />
                <SelectField field="L12M escalated tickets" selected="True" />
                <SelectField field="L12M Escalation Flag" selected="True" />
                <SelectField field="L12M incorrect billing credit notes" selected="True" />
                <SelectField field="L12M increase in amber tickets" selected="True" />
                <SelectField field="L12M increase in red tickets" selected="True" />
                <SelectField field="L12M increase in tickets" selected="True" />
                <SelectField field="L12M increase in tickets2" selected="True" />
                <SelectField field="L12M licenses" selected="True" />
                <SelectField field="L12M licenses delta" selected="True" />
                <SelectField field="L12M SLA closure violations" selected="True" />
                <SelectField field="L12M SLA response violations" selected="True" />
                <SelectField field="L12M SLA violations" selected="True" />
                <SelectField field="L12M ticket count" selected="True" />
                <SelectField field="L12M tickets (amber)" selected="True" />
                <SelectField field="L12M tickets (green)" selected="True" />
                <SelectField field="L12M tickets (red)" selected="True" />
                <SelectField field="L12M tickets closed in 24 hours" selected="True" />
                <SelectField field="L12M tickets closed in 48 hours" selected="True" />
                <SelectField field="L12M tickets reopened" selected="True" />
                <SelectField field="L12M total days tickets open" selected="True" />
                <SelectField field="L12M total discount" selected="True" />
                <SelectField field="L12M upsell M&amp;A" selected="False" />
                <SelectField field="L12M upsell organic" selected="False" />
                <SelectField field="L12M_Avg_NPS_Score" selected="True" />
                <SelectField field="L12M_Change_in_NPS_Score" selected="True" />
                <SelectField field="L24M_Change_in_NPS_Score" selected="True" />
                <SelectField field="L2M credit notes" selected="True" />
                <SelectField field="L2M incorrect billing credit notes" selected="True" />
                <SelectField field="L3M escalated tickets" selected="True" />
                <SelectField field="L3M increase in amber tickets" selected="True" />
                <SelectField field="L3M increase in red tickets" selected="True" />
                <SelectField field="L3M increase in tickets" selected="True" rename="L3M_Increase_in_Ticket_Count" />
                <SelectField field="L3M inrease in tickets" selected="True" />
                <SelectField field="L3M SLA closure violations" selected="True" />
                <SelectField field="L3M SLA response violations" selected="True" />
                <SelectField field="L3M SLA violations" selected="True" />
                <SelectField field="L3M ticket count" selected="True" />
                <SelectField field="L3M tickets (amber)" selected="True" />
                <SelectField field="L3M tickets (green)" selected="True" />
                <SelectField field="L3M tickets (red)" selected="True" />
                <SelectField field="L3M tickets closed in 24 hours" selected="True" />
                <SelectField field="L3M tickets closed in 48 hours" selected="True" />
                <SelectField field="L3M tickets reopened" selected="True" />
                <SelectField field="L3M total days ticket open" selected="True" />
                <SelectField field="L6M account managers" selected="True" />
                <SelectField field="L6M AM interactions" selected="True" />
                <SelectField field="L6M credit notes" selected="True" />
                <SelectField field="L6M escalated tickets" selected="True" />
                <SelectField field="L6M incorrect billing credit notes" selected="True" />
                <SelectField field="L6M increase in amber tickets" selected="True" />
                <SelectField field="L6M increase in red tickets" selected="True" />
                <SelectField field="L6M increase in tickets" selected="True" />
                <SelectField field="L6M increase in tickets2" selected="False" />
                <SelectField field="L6M licenses" selected="True" />
                <SelectField field="L6M licenses delta" selected="True" />
                <SelectField field="L6M SLA closure violations" selected="True" />
                <SelectField field="L6M SLA response violations" selected="True" />
                <SelectField field="L6M SLA violations" selected="True" />
                <SelectField field="L6M ticket count" selected="True" />
                <SelectField field="L6M tickets (amber)" selected="True" />
                <SelectField field="L6M tickets (green)" selected="True" />
                <SelectField field="L6M tickets (red)" selected="True" />
                <SelectField field="L6M tickets closed in 24 hours" selected="True" />
                <SelectField field="L6M tickets closed in 48 hours" selected="True" />
                <SelectField field="L6M tickets reopened" selected="True" />
                <SelectField field="L6M total days tickets open" selected="True" />
                <SelectField field="Licenses" selected="True" />
                <SelectField field="M-12_L12M_Avg_NPS_Score" selected="True" />
                <SelectField field="M-24_L12M_Avg_NPS_Score" selected="True" />
                <SelectField field="Marketing Sector" selected="False" />
                <SelectField field="Month" selected="True" />
                <SelectField field="NPS_Classification" selected="True" />
                <SelectField field="Other Professional Services" selected="True" />
                <SelectField field="Parent customer ID" selected="True" />
                <SelectField field="Parent_BusinessName" selected="True" />
                <SelectField field="Parent_Division" selected="True" />
                <SelectField field="Parent_ID" selected="False" />
                <SelectField field="Parent_No_of_Product_Groups" selected="True" />
                <SelectField field="Parent_No_Product_Families" selected="True" />
                <SelectField field="Pivotal ID" selected="True" />
                <SelectField field="Previous L12M interactions" selected="True" />
                <SelectField field="Previous L6M interactions" selected="True" />
                <SelectField field="Resolution Status_Name" selected="True" />
                <SelectField field="Responded_to_NPS_Survey" selected="True" />
                <SelectField field="Sector" selected="True" />
                <SelectField field="Sectors From Enriched Data" selected="False" />
                <SelectField field="Ticket count (in-month)" selected="True" />
                <SelectField field="Time stamp" selected="True" />
                <SelectField field="Limit" selected="True" />
                <SelectField field="Usage" selected="True" />
                <SelectField field="Usage %" selected="True" />
                <SelectField field="L12M_Delta_Limit" selected="True" />
                <SelectField field="L12M_Delta_Usage" selected="True" />
                <SelectField field="L12M_Delta_Usage_%" selected="True" />
                <SelectField field="L6M_Delta_Limit" selected="True" />
                <SelectField field="L6M_Delta_Usage" selected="True" />
                <SelectField field="L6M_Delta_Usage_%" selected="True" />
                <SelectField field="L3M_Delta_Limit" selected="True" />
                <SelectField field="L3M_Delta_Usage" selected="True" />
                <SelectField field="L3M_Delta_Usage_%" selected="True" />
                <SelectField field="LM_Delta_Limit" selected="True" />
                <SelectField field="LM_Delta_Usage" selected="True" />
                <SelectField field="LM_Delta_Usage_%" selected="True" />
                <SelectField field="*Unknown" selected="True" />
              </SelectFields>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInSelect" />
        </Node>
        <Node ToolID="135">
          <GuiSettings Plugin="LockInGui.LockInStreamOut.LockInStreamOut">
            <Position x="283" y="993" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Sort value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="LockInEngine.dll" EngineDllEntryPoint="AlteryxLockInStreamOut" />
        </Node>
        <Node ToolID="137">
          <GuiSettings Plugin="AlteryxBasePluginsGui.Formula.Formula">
            <Position x="355" y="993" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <FormulaFields>
                <FormulaField expression="[L12M AM interactions] - [Previous L12M interactions]" field="L12M_Interactions_Change" size="8" type="Double" />
              </FormulaFields>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText>L12M_Interactions_Change = [L12M AM interactions] - [Previous L12M interactions]...</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFormula" />
        </Node>
      </ChildNodes>
    </Node>
  </Nodes>
  <Connections>
    <Connection name="#1">
      <Origin ToolID="134" Connection="Join" />
      <Destination ToolID="136" Connection="Input" />
    </Connection>
    <Connection name="#2">
      <Origin ToolID="134" Connection="Left" />
      <Destination ToolID="136" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="136" Connection="Output" />
      <Destination ToolID="11" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="85" Connection="Output" />
      <Destination ToolID="89" Connection="Input" />
    </Connection>
    <Connection Wireless="True">
      <Origin ToolID="86" Connection="Output" />
      <Destination ToolID="128" Connection="Input" />
    </Connection>
    <Connection Wireless="True">
      <Origin ToolID="87" Connection="Output" />
      <Destination ToolID="112" Connection="Right" />
    </Connection>
    <Connection>
      <Origin ToolID="111" Connection="Output" />
      <Destination ToolID="112" Connection="Left" />
    </Connection>
    <Connection>
      <Origin ToolID="87" Connection="Output" />
      <Destination ToolID="86" Connection="Input" />
    </Connection>
    <Connection Wireless="True">
      <Origin ToolID="87" Connection="Output" />
      <Destination ToolID="111" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="88" Connection="Output" />
      <Destination ToolID="87" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="89" Connection="True" />
      <Destination ToolID="88" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="91" Connection="Output" />
      <Destination ToolID="92" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="92" Connection="Output" />
      <Destination ToolID="95" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="92" Connection="Output" />
      <Destination ToolID="97" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="92" Connection="Output" />
      <Destination ToolID="98" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="94" Connection="Output" />
      <Destination ToolID="101" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="95" Connection="True" />
      <Destination ToolID="99" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="96" Connection="Output" />
      <Destination ToolID="104" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="97" Connection="True" />
      <Destination ToolID="100" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="98" Connection="Output" />
      <Destination ToolID="94" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="98" Connection="Output" />
      <Destination ToolID="102" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="99" Connection="Output" />
      <Destination ToolID="96" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="99" Connection="Output" />
      <Destination ToolID="105" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="100" Connection="Output" />
      <Destination ToolID="106" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="100" Connection="Output" />
      <Destination ToolID="108" Connection="Input" />
    </Connection>
    <Connection name="#1">
      <Origin ToolID="101" Connection="Output" />
      <Destination ToolID="103" Connection="Input" />
    </Connection>
    <Connection name="#2">
      <Origin ToolID="104" Connection="Output" />
      <Destination ToolID="103" Connection="Input" />
    </Connection>
    <Connection name="#3">
      <Origin ToolID="107" Connection="Output" />
      <Destination ToolID="103" Connection="Input" />
    </Connection>
    <Connection name="#1">
      <Origin ToolID="102" Connection="Output" />
      <Destination ToolID="109" Connection="Input" />
    </Connection>
    <Connection name="#2">
      <Origin ToolID="105" Connection="Output" />
      <Destination ToolID="109" Connection="Input" />
    </Connection>
    <Connection name="#3">
      <Origin ToolID="108" Connection="Output" />
      <Destination ToolID="109" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="103" Connection="Output" />
      <Destination ToolID="123" Connection="Right" />
    </Connection>
    <Connection>
      <Origin ToolID="127" Connection="Left" />
      <Destination ToolID="123" Connection="Left" />
    </Connection>
    <Connection>
      <Origin ToolID="106" Connection="Output" />
      <Destination ToolID="107" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="109" Connection="Output" />
      <Destination ToolID="127" Connection="Right" />
    </Connection>
    <Connection>
      <Origin ToolID="128" Connection="True" />
      <Destination ToolID="127" Connection="Left" />
    </Connection>
    <Connection>
      <Origin ToolID="112" Connection="Output" />
      <Destination ToolID="113" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="113" Connection="Output" />
      <Destination ToolID="115" Connection="Input" />
    </Connection>
    <Connection Wireless="True">
      <Origin ToolID="114" Connection="Output" />
      <Destination ToolID="129" Connection="Right" />
    </Connection>
    <Connection>
      <Origin ToolID="125" Connection="Output" />
      <Destination ToolID="129" Connection="Left" />
    </Connection>
    <Connection>
      <Origin ToolID="115" Connection="Output" />
      <Destination ToolID="114" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="117" Connection="Output" />
      <Destination ToolID="119" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="117" Connection="Output" />
      <Destination ToolID="120" Connection="Left" />
    </Connection>
    <Connection>
      <Origin ToolID="119" Connection="Output" />
      <Destination ToolID="120" Connection="Right" />
    </Connection>
    <Connection>
      <Origin ToolID="118" Connection="Output" />
      <Destination ToolID="117" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="120" Connection="Join" />
      <Destination ToolID="121" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="121" Connection="Output" />
      <Destination ToolID="134" Connection="Left" />
    </Connection>
    <Connection>
      <Origin ToolID="137" Connection="Output" />
      <Destination ToolID="134" Connection="Right" />
    </Connection>
    <Connection>
      <Origin ToolID="122" Connection="Output" />
      <Destination ToolID="118" Connection="Input" />
    </Connection>
    <Connection name="#1">
      <Origin ToolID="123" Connection="Left" />
      <Destination ToolID="124" Connection="Input" />
    </Connection>
    <Connection name="#2">
      <Origin ToolID="123" Connection="Join" />
      <Destination ToolID="124" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="124" Connection="Output" />
      <Destination ToolID="126" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="126" Connection="Output" />
      <Destination ToolID="125" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="129" Connection="Join" />
      <Destination ToolID="122" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="35" Connection="Output" />
      <Destination ToolID="36" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="36" Connection="Output" />
      <Destination ToolID="37" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="26" Connection="Output" />
      <Destination ToolID="35" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="28" Connection="Output" />
      <Destination ToolID="30" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="29" Connection="Output" />
      <Destination ToolID="32" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="30" Connection="Output" />
      <Destination ToolID="31" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="44" Connection="Output" />
      <Destination ToolID="45" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="45" Connection="True" />
      <Destination ToolID="46" Connection="Right" />
    </Connection>
    <Connection>
      <Origin ToolID="46" Connection="Output" />
      <Destination ToolID="47" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="47" Connection="Output" />
      <Destination ToolID="48" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="40" Connection="Output" />
      <Destination ToolID="41" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="41" Connection="Output" />
      <Destination ToolID="43" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="39" Connection="Output" />
      <Destination ToolID="42" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="4" Connection="Output" />
      <Destination ToolID="5" Connection="Input" />
    </Connection>
    <Connection name="#2">
      <Origin ToolID="5" Connection="Output" />
      <Destination ToolID="8" Connection="Input" />
    </Connection>
    <Connection name="#1">
      <Origin ToolID="11" Connection="Output" />
      <Destination ToolID="8" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="10" Connection="Output" />
      <Destination ToolID="16" Connection="Input" />
    </Connection>
    <Connection Wireless="True">
      <Origin ToolID="16" Connection="Output" />
      <Destination ToolID="26" Connection="Left" />
    </Connection>
    <Connection Wireless="True">
      <Origin ToolID="16" Connection="Output" />
      <Destination ToolID="39" Connection="Input" />
    </Connection>
    <Connection Wireless="True">
      <Origin ToolID="16" Connection="Output" />
      <Destination ToolID="40" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="16" Connection="Output" />
      <Destination ToolID="135" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="135" Connection="Output" />
      <Destination ToolID="137" Connection="Input" />
    </Connection>
  </Connections>
  <Properties>
    <Memory default="True" />
    <GlobalRecordLimit value="0" />
    <TempFiles default="True" />
    <Annotation on="True" includeToolName="False" />
    <ConvErrorLimit value="10" />
    <ConvErrorLimit_Stop value="False" />
    <CancelOnError value="False" />
    <DisableBrowse value="False" />
    <EnablePerformanceProfiling value="False" />
    <PredictiveToolsCodePage value="1252" />
    <DisableAllOutput value="False" />
    <ShowAllMacroMessages value="False" />
    <ShowConnectionStatusIsOn value="True" />
    <ShowConnectionStatusOnlyWhenRunning value="True" />
    <ZoomLevel value="0" />
    <LayoutType>Horizontal</LayoutType>
    <MetaInfo>
      <NameIsFileName value="True" />
      <Name>Master - HCM Model Retrain</Name>
      <Description />
      <RootToolName />
      <ToolVersion />
      <ToolInDb value="False" />
      <CategoryName />
      <SearchTags />
      <Author />
      <Company />
      <Copyright />
      <DescriptionLink actual="" displayed="" />
      <Example>
        <Description />
        <File />
      </Example>
      <WorkflowId value="39831c34-5bae-4b74-b32f-e377c42549a9" />
      <Telemetry>
        <PreviousWorkflowId value="949adb84-e984-4124-8eea-bc568c13e887" />
        <OriginWorkflowId value="ad9d3c4a-5a99-45e9-a46b-cc7c2fdfa1d9" />
      </Telemetry>
    </MetaInfo>
    <Events>
      <Enabled value="True" />
    </Events>
  </Properties>
</AlteryxDocument>